"use strict";(self["webpackChunkdoapp_crmtheme"]=self["webpackChunkdoapp_crmtheme"]||[]).push([[6761,7106,8215,2394],{27106:function(e,t,a){a.r(t),t["default"]={0:"#f8f9fa",1:"#bbecf1",2:"#98e1dc",3:"#e3f299",4:"#ffee95",5:"#ffdd93",6:"#dfd3b6",7:"#e3c6bb",8:"#ffad97",9:"#ffbdbb",10:"#ffcbd8",11:"#ffc4e4",12:"#c4baed",13:"#dbdde0",14:"#bfc5cd",15:"#ffffff",16:"#2eceff",17:"#10e5fc",18:"#a5de00",19:"#eec200",20:"#ffa801",21:"#ad8f47",22:"#b57051",23:"#ff5b55",24:"#ef3000",25:"#f968b6",26:"#6b52cc",27:"#06bab1",28:"#5cd1df",29:"#a1a6ac",30:"#949da9",31:"#ffb79f",32:"#ffbf99",33:"#f3e27c",34:"#e7d35d",35:"#53e553",36:"#00a64c",37:"#48dfdf",38:"#de62de",39:"#ef008b",40:"#0000ff",41:"#ebebeb",42:"#acacac",43:"#898989",44:"#f89675",45:"#fdad7e",46:"#fec788",47:"#fff893",48:"#c5e099",49:"#a3d49b",50:"#8ed1a8",51:"#7ecb9c",52:"#78cdca",53:"#67cef9",54:"#7aa5da",55:"#887fc0",56:"#a284bf",57:"#bd8bc0",58:"#f69ac1",59:"#f6989c",60:"#f26b47",61:"#f78d4d",62:"#fdb051",63:"#fff55a",64:"#abd46c",65:"#7bc56f",66:"#00bbb4",67:"#00bef6",68:"#00bdb5",69:"#3fb2cd",70:"#3f8bcd",71:"#5471b9",72:"#865daa",73:"#a861ab",74:"#f16ca8",75:"#f26b7b",76:"#f11716",77:"#f36509",78:"#f99500",79:"#fff300",80:"#8ec82f",81:"#2fb644",82:"#00a74c",83:"#00a99d",84:"#00adf2",85:"#0070bf",86:"#0052a7",87:"#662793",88:"#922091",89:"#f0008c",90:"#f10057",91:"#9e0502",92:"#a34100",93:"#a46200",94:"#aba100",95:"#578520",96:"#107c2c",97:"#007333",98:"#00736a",99:"#0075a6",100:"#004982",101:"#003172",102:"#1c0d64",103:"#460663",104:"#630060",105:"#a0005c",106:"#9f0037",107:"#2e2d93",108:"#555555",109:"#000000"}},82394:function(e,t,a){a.r(t);a(82801),a(61295);const s={computed:{getPresets(){return this.getKanbanSettings?.presets??[]},getActivePreset(){return this.getPresets.find((e=>!0===e.isActive))},getDetailLink(){return"?module="+this.module+"&offset="+this.offset+"&stamp="+this.stamp+"&record="+this.recordId+"&return_module="+this.module+"&parentTab="+this.parentTab+"&return_action=ListView&return_subAction=Kanban&action=DetailView"},getEditLink(){return"?module="+this.module+"&offset="+this.offset+"&stamp="+this.stamp+"&record="+this.recordId+"&return_module="+this.module+"&parentTab="+this.parentTab+"&return_action=ListView&return_subAction=Kanban&action=EditView"},pageData(){return this.$store.state.focus.data.pageData?this.$store.state.focus.data.pageData:{}},stamp(){return this.pageData.stamp?this.pageData.stamp:"0"},offset(){return this.pageData.offset?this.pageData.offset:"1"},parentTab(){return this.pageData.parentTab?this.pageData.parentTab:this.DOAPP.utils.translate("LBL_LINK_ALL")},module(){return this.$route.query.module},getKanbanSettings(){return this.$store.state.app.setting.kanban[this.module]},getSearchQuery(){return this.getKanbanSettings?this.getKanbanSettings.searchQuery:""}},methods:{async clearAll(e){await this.clearForm(),await this.applyForm(e),this.$store.commit("app/DEACTIVATE_KANBAN_PRESETS",this.module),window.$("#collapseKanbanSearchForm").collapse("hide"),window.$("#collapseKanbanPresetActions").collapse("hide")},clearForm(){this.$store.commit("focus/CLEAN_MODEL_PATH_VALUES",{path:"filters",row:"kanban",fields:this.$store.state.focus.data.filters.layout.advanced})},togglePresetActions(e){this.getSearchQuery||this.clearForm(e),window.$("#collapseKanbanSearchForm").collapse("hide"),window.$("#collapseKanbanPresetActions").collapse("toggle")},toggleFilter(){window.$("#collapseKanbanPresetActions").collapse("hide"),window.$("#collapseKanbanSearchForm").collapse("toggle")},async clearAndSearch(e){await this.clearForm(),await this.applyForm(e),this.$store.commit("app/DEACTIVATE_KANBAN_PRESETS",this.module)},async applyForm(e){let t=new FormData(e.target.form);await Object.keys(this.enumOptions).forEach((e=>{this.fetchKanbanColumnData(e,0,t)})),this.$store.dispatch("app/setKanbanFilterData"),this.$store.dispatch("app/setKanbanSearchQuery"),this.$store.dispatch("app/setSettings")},fetchKanbanColumnData(e,t="0",a=null){let s={module_name:this.$route.query.module,order:this.orderFieldName,offset:t,sortDirection:this.getKanbanSettings.sortDirection??"",status_field_name:this.fieldToEnum,status_field_value:e};this.$store.dispatch("focus/setKanbanData",{params:s,formData:a})},getSearchFormData(){let e=new FormData;if(e.append("searchFormTab","advanced_search"),this.getKanbanSettings){for(let t in this.getKanbanSettings.filters)this.getKanbanSettings.filters[t]&&e.append(t,this.getKanbanSettings.filters[t]);return e}return null},async openCreatePopup(e,t,a){let s=await this.getQuickCreateView(a),r=this.setQuickCreateParams(s,this.quickCreateParams),i={type:"quickCreate",header:{data:{title:"LBL_EMAIL_QUICK_CREATE",module:a},show:!0},body:{data:r,show:!0},footer:{data:{},show:!0}};i.body.data.module=a,i.body.data.record="",this.$store.dispatch("popup/setSize","xl"),this.$store.dispatch("popup/fill",i),this.$store.dispatch("popup/show")},async getQuickCreateView(e){let t={get:{module:"Home",VueAjax:1,method:"quickCreateView",arg:{targetModule:e}}},a=await this.$store.dispatch("ajaxGet",t);return a.data},setQuickCreateParams(e,t){let a=structuredClone(e);return t.forEach((e=>{a.beanData[e.name].value=e.value})),a},async chooseKanbanPreset(e){let t={id:e.target.id,module:this.module};await this.$store.dispatch("app/chooseKanbanPreset",t),await this.$store.dispatch("focus/setKanbanPresetValues",t),await this.applyForm(e),this.$store.commit("app/SET_ACTIVE_KANBAN_PRESET",t)}}};t["default"]=s},36761:function(e,t,a){a.r(t),a.d(t,{default:function(){return w}});var s=a(73396),r=a(87139);const i={class:"item-left","data-dr-handle":""},n=["title"],d={"data-dr-handle":""},o={class:"item-right"},l={class:"badge bg-gray-light"},c=["title"],u=["id"];function f(e,t,a,f,h,p){const m=(0,s.up)("daKanbanColumnItem");return(0,s.wg)(),(0,s.iD)("div",{class:(0,r.C_)(["card",{"kanban-hide":h.hide,"kanban-col":!h.hide}])},[(0,s._)("div",{"data-dr-handle":"",class:"card-header column-header",style:(0,r.j5)({backgroundColor:p.getHexes[a.index]})},[(0,s._)("div",i,[(0,s._)("i",{class:(0,r.C_)(["bi",{"bi-chevron-right":!h.hide,"bi-chevron-down":h.hide}]),role:"button",title:e.DOAPP.utils.translate("LBL_HIDE"),onClick:t[0]||(t[0]=(...e)=>p.collapseHandler&&p.collapseHandler(...e))},null,10,n),(0,s._)("span",d,(0,r.zw)(a.statusKey?a.statusTranslate:"-----"),1)]),(0,s._)("div",o,[(0,s._)("span",l,(0,r.zw)(p.getColumnRecordListLength),1),(0,s._)("i",{class:"bi bi-plus-square",role:"button",title:e.DOAPP.utils.translate("LBL_ADD_BUTTON"),onClick:t[1]||(t[1]=(...e)=>p.plusHandler&&p.plusHandler(...e))},null,8,c)])],4),(0,s._)("div",{"data-dr-container":"column",id:a.statusKey,onScroll:t[2]||(t[2]=(...e)=>p.scrollHandler&&p.scrollHandler(...e)),class:"card-body scroll-padding"},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(p.getColumnRecordList,((t,a,r)=>((0,s.wg)(),(0,s.j4)(m,{key:a,recordAccess:p.getColumnRecordAccess[a],recordFields:t,recordId:a,module:e.module,offset:e.offset,index:r},null,8,["recordAccess","recordFields","recordId","module","offset","index"])))),128))],40,u)],2)}var h=a(28215),p=a(82394),m=a(27106),b={name:"daKanbanColumn",components:{daKanbanColumnItem:h["default"]},mixins:[p["default"]],emits:["updatedRecords"],props:{getKanban:{type:Object,required:!0},fieldToEnum:{type:String,required:!0},statusTranslate:{type:String,required:!0},statusKey:{type:String,required:!0},index:{type:Number,required:!0}},data(){return{hide:!1}},updated(){this.$emit("updatedRecords")},computed:{getHexes(){return m["default"]},columnData(){return this.getKanban?this.getKanban[this.statusKey]:{}},quickCreateParams:{get(){return[{name:this.fieldToEnum,value:this.statusKey}]},set(e){console.log(e)}},getColumnRecordList(){return this.columnData?this.columnData.recordList:{}},getColumnRecordListLength(){return this.columnData?this.columnData.rowCount:0},getColumnRecordAccess(){return this.columnData?this.columnData.recordAccess:0}},methods:{collapseHandler(){this.toggleColumn()},toggleColumn(){this.hide=!this.hide},plusHandler(){this.openCreatePopup(this.fieldToEnum,this.statusKey,this.module)},scrollHandler(e){this.endOfScrollHandler(e)},endOfScrollHandler(e){const t=e.target.scrollHeight,a=e.target.scrollTop,s=e.target.clientHeight;if(t===a+s){let e=this.getSearchFormData();this.fetchKanbanColumnData(this.statusKey,this.columnData.nextOffset,e)}}}},g=a(40089);const _=(0,g.Z)(b,[["render",f],["__scopeId","data-v-070e94f6"]]);var w=_},28215:function(e,t,a){a.r(t),a.d(t,{default:function(){return D}});var s=a(73396),r=a(87139);const i=["data-dr-item"],n={class:"card card-info card-outline"},d={"data-dr-handle":"",class:"card-header"},o={"data-dr-handle":"",class:"card-title"},l={class:"card-body"},c={class:"footer-tools"},u={class:"item-left"},f={class:"item-right"},h=(0,s._)("i",{class:"bi bi-eye"},null,-1),p=(0,s._)("i",{class:"bi bi-pencil-square"},null,-1);function m(e,t,a,m,b,g){const _=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("div",{"data-dr-item":a.recordId},[(0,s._)("div",n,[(0,s._)("div",d,[(0,s._)("h5",o,(0,r.zw)(a.recordFields.name),1)]),(0,s._)("div",l,[(0,s._)("p",null,(0,r.zw)(a.recordFields.description),1),(0,s._)("div",c,[(0,s._)("div",u,[(0,s._)("span",null,(0,r.zw)("#"+a.index),1)]),(0,s._)("div",f,[a.recordAccess["detail"]?((0,s.wg)(),(0,s.j4)(_,{key:0,to:e.getDetailLink,role:"button",title:e.DOAPP.utils.translate("LBL_VIEW_BUTTON")},{default:(0,s.w5)((()=>[h])),_:1},8,["to","title"])):(0,s.kq)("",!0),a.recordAccess["edit"]?((0,s.wg)(),(0,s.j4)(_,{key:1,to:e.getEditLink,role:"button",title:e.DOAPP.utils.translate("LBL_EDIT_BUTTON")},{default:(0,s.w5)((()=>[p])),_:1},8,["to","title"])):(0,s.kq)("",!0)])])])])],8,i)}var b=a(82394),g={name:"daKanbanColumnItem",props:{recordAccess:{type:Object,required:!0},recordFields:{type:Object,required:!0},recordId:{type:String,required:!0},index:{type:[String,Number],required:!0}},mixins:[b["default"]]},_=a(40089);const w=(0,_.Z)(g,[["render",m]]);var D=w}}]);