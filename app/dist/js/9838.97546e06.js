"use strict";(self["webpackChunkdoapp_crmtheme"]=self["webpackChunkdoapp_crmtheme"]||[]).push([[9838,2318],{72318:function(t,a,e){e.r(a),e.d(a,{default:function(){return q}});var s=e(73396),i=e(87139);const l=["id"],o=["id"],n={"data-dr-handle":"",class:"card-title"},d={class:"card-tools"},r=["title","aria-label"],p=(0,s._)("i",{class:"fas fa-cogs"},null,-1),h=[p],g=["title","aria-label"],c=(0,s._)("i",{class:"fas fa-sync-alt"},null,-1),D=[c],u=["title","aria-label"],f=(0,s._)("i",{class:"fas fa-times"},null,-1),_=[f],m={class:"card-body p-0"},P={class:"table-responsive"},v={class:"card-footer"},b={key:0,class:"pagination pagination-sm m-0 float-right"},w=["title"],L=(0,s._)("a",{class:"page-link",href:"javascript:void(0)"},[(0,s._)("i",{class:"fas fa-angle-double-left"})],-1),H=[L],k=["title"],E=(0,s._)("a",{class:"page-link",href:"javascript:void(0)"},[(0,s._)("i",{class:"fas fa-angle-left"})],-1),O=[E],y={class:"page-item disabled"},B={class:"page-link",href:"javascript:void(0)"},A=["title"],C=(0,s._)("a",{class:"page-link",href:"javascript:void(0)"},[(0,s._)("i",{class:"fas fa-angle-right"})],-1),T=[C],N=["title"],S=(0,s._)("a",{class:"page-link",href:"javascript:void(0)"},[(0,s._)("i",{class:"fas fa-angle-double-right"})],-1),I=[S];function j(t,a,e,p,c,f){const L=(0,s.up)("daTable");return(0,s.wg)(),(0,s.iD)("div",{id:e.data.id,class:"card"},[(0,s._)("div",{"data-dr-handle":"",class:"card-header",id:"dashlet_header_"+e.data.id},[(0,s._)("h3",n,[(0,s._)("i",{"data-dr-handle":"",class:(0,i.C_)(["mr-1 suitepicon",f.moduleIcon()])},null,2),(0,s.Uk)(" "+(0,i.zw)(e.data.label),1)]),(0,s._)("div",d,[e.lockHomepage?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("button",{key:0,type:"button",class:"btn btn-tool",title:t.DOAPP.utils.translate("LBL_DASHLET_EDIT","Home"),"aria-label":t.DOAPP.utils.translate("LBL_DASHLET_EDIT","Home"),onClick:a[0]||(a[0]=(...t)=>f.configDashlets&&f.configDashlets(...t))},h,8,r)),(0,s._)("button",{type:"button",class:"btn btn-tool",title:t.DOAPP.utils.translate("LBL_DASHLET_REFRESH","Home"),"aria-label":t.DOAPP.utils.translate("LBL_DASHLET_REFRESH","Home"),onClick:a[1]||(a[1]=(...t)=>f.retrieveDashlet&&f.retrieveDashlet(...t))},D,8,g),e.lockHomepage?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("button",{key:1,type:"button",class:"btn btn-tool",title:t.DOAPP.utils.translate("LBL_DASHLET_DELETE","Home"),"aria-label":t.DOAPP.utils.translate("LBL_DASHLET_DELETE","Home"),onClick:a[2]||(a[2]=(...t)=>f.deleteDashlet&&f.deleteDashlet(...t))},_,8,u))])],8,o),(0,s._)("div",m,[(0,s._)("div",P,[f.pageData?((0,s.wg)(),(0,s.j4)(L,{key:Date.now(),onSortHandler:f.sortHandler,tableId:e.data.id,name:f.pageData.bean.moduleDir+"_"+e.data.id,module:f.pageData.bean.moduleDir,viewData:f.viewData,pageData:f.pageData,viewOptions:{view:"dashlet",activePage:this.activePage,addInfo:!1,dashletId:e.data.id,editViewLinksEnable:e.data.editViewLinksEnable}},null,8,["onSortHandler","tableId","name","module","viewData","pageData","viewOptions"])):(0,s.kq)("",!0)])]),(0,s._)("div",v,[f.dataNotEmpty()?((0,s.wg)(),(0,s.iD)("ul",b,[f.paginationBtn.start?((0,s.wg)(),(0,s.iD)("li",{key:0,class:"page-item",name:"listViewStartButton",title:t.DOAPP.utils.translate("LNK_LIST_START"),onClick:a[3]||(a[3]=t=>f.paginationHandler(f.paginationBtn.start))},H,8,w)):(0,s.kq)("",!0),f.paginationBtn.previous?((0,s.wg)(),(0,s.iD)("li",{key:1,class:"page-item",id:"listViewPrevButton_top",name:"listViewPrevButton",title:t.DOAPP.utils.translate("LNK_LIST_PREVIOUS"),onClick:a[4]||(a[4]=t=>f.paginationHandler(f.paginationBtn.previous))},O,8,k)):(0,s.kq)("",!0),(0,s._)("li",y,[(0,s._)("a",B,(0,i.zw)(f.paginationInfo()),1)]),f.paginationBtn.next?((0,s.wg)(),(0,s.iD)("li",{key:2,class:"page-item",id:"listViewNextButton_top",name:"listViewNextButton",title:t.DOAPP.utils.translate("LNK_LIST_NEXT"),onClick:a[5]||(a[5]=t=>f.paginationHandler(f.paginationBtn.next))},T,8,A)):(0,s.kq)("",!0),f.paginationBtn.end?((0,s.wg)(),(0,s.iD)("li",{key:3,class:"page-item",id:"listViewEndButton_top",name:"listViewEndButton",title:t.DOAPP.utils.translate("LNK_LIST_END"),onClick:a[6]||(a[6]=t=>f.paginationHandler(f.paginationBtn.end))},I,8,N)):(0,s.kq)("",!0)])):(0,s.kq)("",!0)])],8,l)}var x=e(66321),$={name:"DashletCard",components:{daTable:x["default"]},props:{data:{type:Object},lockHomepage:{type:Boolean},activePage:{type:Number}},computed:{pageData(){return!this.DOAPP.utils.isEmpty(this.data.pageData)&&this.data.pageData},module(){return this.pageData&&this.pageData.bean?this.pageData.bean.moduleName:(console.error("Module name is not found"),!1)},viewData(){return this.data.viewData},paginationBtn(){let t={start:!1,previous:!1,next:!1,end:!1};return this.pageData.urls.startPage&&(t["start"]=this.pageData.urls.startPage),this.pageData.urls.prevPage&&(t["previous"]=this.pageData.urls.prevPage),this.pageData.urls.nextPage&&(t["next"]=this.pageData.urls.nextPage),this.pageData.urls.endPage&&Number(this.pageData.offsets.total)!==Number(this.pageData.offsets.lastOffsetOnPage)&&(t["end"]=this.pageData.urls.endPage),t}},methods:{retrieveDashlet(){let t={id:this.data.id,page_id:this.activePage,to_pdf:!0,entryPoint:"retrieve_dash_page"};this.$store.dispatch("focus/retrieveDashPage",t)},sortHandler(t){let a={},e="Home2_"+this.pageData.bean.objectName+"_ORDER_BY";a.entryPoint="retrieve_dash_page",a.id=this.data.id,a.page_id=this.activePage,a[e]=t,a.lvso=this.pageData.queries.orderBy.lvso,a.to_pdp=!0,this.$store.dispatch("focus/retrieveDashPage",a)},dataNotEmpty(){return!this.DOAPP.utils.isEmpty(this.viewData.data)},paginationInfo(){let t="";return t=0===this.pageData.offsets.lastOffsetOnPage?"0":1*this.pageData.offsets.current+1,t+=" - "+this.pageData.offsets.lastOffsetOnPage,t+=" "+this.DOAPP.utils.translate("LBL_LIST_OF")+" ",this.pageData.offsets.totalCounted?t+=this.pageData.offsets.total:(t+=this.pageData.offsets.total,this.pageData.offsets.lastOffsetOnPage!==this.pageData.offsets.total&&(t+="+")),t},paginationHandler(t){let a=decodeURI(t.substring(t.indexOf("?")+1)),e={},s=["module","action","DynamicAction","lvso"];a.split("&").forEach((t=>{let[a,i]=t.split("=");s.includes(a)||(e[a]=i)})),e.page_id=this.activePage,e.entryPoint="retrieve_dash_page",Object.hasOwn(e,"Home2_"+this.pageData.bean.objectName.toUpperCase()+"_"+this.data.id+"_offset")||(Number(e["Home2_"+this.pageData.bean.objectName.toUpperCase()+"_offset"])===Number(this.pageData.offsets.end)?e["Home2_"+this.pageData.bean.objectName.toUpperCase()+"_"+this.data.id+"_offset"]=this.pageData.offsets.end:e["Home2_"+this.pageData.bean.objectName.toUpperCase()+"_"+this.data.id+"_offset"]=this.pageData.offsets.next),this.$store.dispatch("focus/retrieveDashPage",e)},moduleIcon(){let t=!1;return this.pageData&&(t="suitepicon-module-"+this.pageData.bean.moduleDir.toLowerCase()),t},async configDashlets(){let{title:t,data:a}=await this.$store.dispatch("focus/retrieveDashlet",this.data.id);this.open_popup(t,a,"DashletConfig",this.saveDashletConfigHandler)},deleteDashlet(){this.DOAPP.swal.getConfirmToast({title:this.DOAPP.utils.translate("LBL_DASHLET_DELETE","Home"),text:this.DOAPP.utils.translate("LBL_REMOVE_DASHLET_CONFIRM","Home"),onConfirmed:this.deleteHandler})},deleteHandler(){this.$store.dispatch("focus/deleteDashletDialog",{activePage:this.activePage,id:this.data.id},{root:!0}),this.$store.dispatch("popup/hide")},async saveDashletConfigHandler(){let t=document.querySelector("form[id=dashletConfig]"),a=new FormData(t),e=new FormData;for(let i of a.entries())"date_entered"===i[0]||"date_start"===i[0]?e.append("type_"+i[0],i[1]):e.append(i[0],i[1]);let s={entryPoint:"retrieve_dash_page",id:this.data.id,page_id:this.activePage,to_pdp:!0};await this.$store.dispatch("ajaxPost",{data:e}),await this.$store.dispatch("focus/retrieveDashPage",s),this.$store.dispatch("popup/hide")},open_popup(t,a,e="",s){this.$store.dispatch("popup/setSize","lg"),this.$store.dispatch("popup/fill",{type:e,header:{show:!0,data:{title:t}},body:{show:!0,data:{data:a,module:this.module,record:this.data.id}},footer:{show:!0,data:{onConfirm:s}}}),this.$store.dispatch("popup/show")}}},R=e(40089);const V=(0,R.Z)($,[["render",j]]);var q=V}}]);