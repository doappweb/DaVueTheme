"use strict";(self["webpackChunkdoapp_crmtheme"]=self["webpackChunkdoapp_crmtheme"]||[]).push([[4355,7290,6385,7222],{34355:function(e,t,s){s.r(t),s.d(t,{default:function(){return V}});var a=s(73396),i=s(87139),l=s(49242);const n=e=>((0,a.dD)("data-v-669f7b5d"),e=e(),(0,a.Cn)(),e),o={class:"row justify-content-between border-bottom"},r=n((()=>(0,a._)("i",{class:"mr-1 suitepicon suitepicon-module-history text-sm"},null,-1))),d={class:"col-md-12 col-lg-6 p-0"},u=["disabled"],c={value:"update_list"},m={value:"update_summary"},p={key:0,id:"case_updates",ref:"case_updates"},h=["placeholder"],_={key:0,class:"d-flex justify-content-between border-bottom pb-2"},w={class:"custom-control custom-switch"},y={for:"internal",class:"custom-control-label small"},b={class:"input-group-sm"},g={class:"input-group-append"},D={key:0,class:"timeline mb-0 py-2"},f={class:"timeline-item"},T={class:"d-flex justify-content-between flex-wrap py-1"},k={class:"timeline-header"},L={class:"time"},C=n((()=>(0,a._)("i",{class:"fas fa-clock"},null,-1))),v={key:0},O={key:1},A={key:2,class:"m-0"},x={class:"text-bold mt-1"},E={class:"timeline-footer d-flex justify-content-end"},S=["onClick"],P={key:1,class:"container"},U={class:"text-center py-4 text-muted"};function z(e,t,s,n,z,j){const B=(0,a.up)("TabPreloader"),N=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",o,[(0,a._)("h5",null,[r,(0,a.Uk)(" "+(0,i.zw)(e.DOAPP.utils.translate("LBL_ACCUMULATED_HISTORY_BUTTON_LABEL")),1)]),(0,a._)("div",d,["Cases"===this.module?(0,a.wy)(((0,a.wg)(),(0,a.iD)("select",{key:0,class:"custom-select py-0",id:"select",name:"select","onUpdate:modelValue":t[0]||(t[0]=e=>j.timelineType=e),disabled:j.selectDisabled},[(0,a._)("option",c,(0,i.zw)(e.DOAPP.utils.translate("LBL_MODULE_NAME","AOP_Case_Updates")),1),(0,a._)("option",m,(0,i.zw)(e.DOAPP.utils.translate("LBL_ACCUMULATED_HISTORY_BUTTON_LABEL")+"+"+e.DOAPP.utils.translate("LBL_MODULE_NAME","AOP_Case_Updates")),1)],8,u)),[[l.bM,j.timelineType]]):(0,a.kq)("",!0)])]),"Cases"===this.module?((0,a.wg)(),(0,a.iD)("form",p,[(0,a.wy)((0,a._)("textarea",{name:"update_text",id:"update_text",placeholder:e.DOAPP.utils.translate("LBL_UPDATE_TEXT",s.module),onClick:t[1]||(t[1]=(...e)=>j.showFullForm&&j.showFullForm(...e)),class:(0,i.C_)(["textarea-style form-control form-control-sm mt-2 mb-2",j.textareaClass]),"onUpdate:modelValue":t[2]||(t[2]=e=>z.updateText=e)},null,10,h),[[l.nr,z.updateText]]),z.fullForm?((0,a.wg)(),(0,a.iD)("div",_,[(0,a._)("div",w,[(0,a.wy)((0,a._)("input",{type:"checkbox",class:"custom-control-input",id:"internal",name:"internal","onUpdate:modelValue":t[3]||(t[3]=e=>z.internal=e)},null,512),[[l.e8,z.internal]]),(0,a._)("label",y,(0,i.zw)(e.DOAPP.utils.translate("LBL_INTERNAL",s.module)),1)]),(0,a._)("div",b,[(0,a._)("div",g,[(0,a._)("button",{class:"btn btn-flat btn-info",type:"button",onClick:t[4]||(t[4]=(...e)=>j.saveCaseUpdates&&j.saveCaseUpdates(...e))},(0,i.zw)(this.DOAPP.utils.translate("LBL_SAVE_BUTTON_LABEL",s.module)),1)])])])):(0,a.kq)("",!0)],512)):(0,a.kq)("",!0),(0,a._)("div",{class:"overflow-auto mb-3 border rounded timeline-wrapper thin-scroll",style:(0,i.j5)(j.timelineStyle)},[(0,a.Wm)(B,{isShow:z.preloaderShow},null,8,["isShow"]),j.emptyShow?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",D,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(j.summaryData,((t,l)=>((0,a.wg)(),(0,a.iD)("div",{key:l},[(0,a._)("i",{class:(0,i.C_)(["far suitepicon",j.iconClass(t.module)])},null,2),(0,a._)("div",f,[(0,a._)("div",T,[(0,a._)("h3",k,[(0,a.Uk)((0,i.zw)(t.direction)+" "+(0,i.zw)(t.type)+" ",1),(0,a._)("b",null,(0,i.zw)(t.contact_name),1),(0,a._)("b",null,(0,i.zw)(t.status),1)]),(0,a._)("span",L,[C,(0,a.Uk)(" "+(0,i.zw)(t.date_type)+" "+(0,i.zw)(t.date_modified),1)])]),(0,a._)("div",{class:(0,i.C_)(["timeline-body border-top",t.class])},[t.acl.detail?((0,a.wg)(),(0,a.iD)("h5",v,[(0,a.Wm)(N,{to:{query:{module:t.module,action:"DetailView",record:t.id}}},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(t.name)+" "+(0,i.zw)(t.attachment),1)])),_:2},1032,["to"])])):((0,a.wg)(),(0,a.iD)("h5",O,(0,i.zw)(t.name)+" "+(0,i.zw)(t.attachment),1)),t.acl.detail?((0,a.wg)(),(0,a.iD)("p",A,(0,i.zw)(t.description),1)):(0,a.kq)("",!0),Object.hasOwn(t,"attachments")&&!Array.isArray(t.attachments)?((0,a.wg)(),(0,a.iD)(a.HY,{key:3},[(0,a._)("span",x,(0,i.zw)(e.DOAPP.utils.translate("LBL_AOP_CASE_ATTACHMENTS",s.module)),1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.attachments,((e,t)=>((0,a.wg)(),(0,a.j4)(N,{key:t,class:"pl-2",to:"?module=Notes&action=DetailView&record="+t},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e),1)])),_:2},1032,["to"])))),128))],64)):(0,a.kq)("",!0)],2),(0,a._)("div",E,[t.acl.edit?((0,a.wg)(),(0,a.j4)(N,{key:0,class:"btn btn-info btn-sm ml-1",to:{query:{module:t.module,action:"EditView",record:t.id,return_module:this.module,return_action:"DetailView",return_id:this.record}}},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.DOAPP.utils.translate("LBL_EDIT_BUTTON")),1)])),_:2},1032,["to"])):(0,a.kq)("",!0),t.acl.delete?((0,a.wg)(),(0,a.iD)("a",{key:1,class:"btn btn-danger btn-sm ml-1",onClick:e=>j.deleteRelationship(t)},(0,i.zw)(e.DOAPP.utils.translate("LBL_DELETE_BUTTON")),9,S)):(0,a.kq)("",!0)])])])))),128))])),j.emptyShow?((0,a.wg)(),(0,a.iD)("div",P,[(0,a._)("p",U,(0,i.zw)(e.DOAPP.utils.translate("MSG_LIST_VIEW_NO_RESULTS_BASIC")),1)])):(0,a.kq)("",!0)],4)],64)}var j=s(96385),B={name:"TimeLine",components:{TabPreloader:j["default"]},props:{sectorHeight:Number,module:String,record:String},data(){return{timelineData:!1,preloaderShow:!0,internal:!1,updateText:"",fullForm:!1}},mounted(){this.getData(),this.setEventListener()},unmounted(){this.removeListener()},computed:{timelineStyle(){return this.timelineData?{"max-height":this.sectorHeight+"px"}:{}},summaryData(){return"Cases"===this.module?this.timelineData[this.timelineType]:this.timelineData.summary_list},emptyShow(){return!(this.timelineData&&!this.DOAPP.utils.isEmpty(this.summaryData))},textareaClass(){return this.fullForm?"textarea-focus":"textarea-blur"},selectDisabled(){return"Cases"===this.module&&!1===this.caseTimelineValue},caseTimelineValue(){return!Object.hasOwn(this.$store.state.app.setting.theme,"Cases_timeLine")||this.$store.state.app.setting.theme.Cases_timeLine},timelineType:{get(){return Object.hasOwn(this.$store.state.app.setting.theme,"timelineType")?this.$store.state.app.setting.theme.timelineType:"update_list"},set(e){let t=this.$store.state.app.setting;t.theme.timelineType=e,this.$store.dispatch("app/setSettings",t)}}},methods:{async deleteRelationship(e){let t=new FormData;t.append("module",this.module),t.append("action","DeleteRelationship"),t.append("record",this.record),t.append("linked_field",e.module.toLowerCase()),t.append("linked_id",e.id),t.append("refresh_page",1),await this.$store.dispatch("ajaxPost",{data:t,sanitize:!1}),this.$store.commit("app/SET_CONTENT_READY",!1),this.$store.commit("app/SET_CONTENT_READY",!0)},async getData(){let e=await this.$store.dispatch("ajaxGet",{get:{VueAjax:1,method:"getTimeline",arg:{module_name:this.module,record:this.record}},sanitize:!1});this.timelineData=e.data,this.preloaderShow=!1,console.log(this.emptyShow),console.log(this.timelineData)},iconClass(e){let t,s="suitepicon-module-"+e.replaceAll("_","-").toLowerCase();return t="Emails"===e?"bg-blue":"Meetings"===e?"bg-yellow":"Calls"===e?"bg-green":"Tasks"===e?"bg-indigo":"Notes"===e?"bg-cyan":"Cases"===e?"bg-purple":"bg-gray",s+" "+t},async saveCaseUpdates(){let e=new FormData(event.target.form);e.set("record",this.record),e.set("module",this.module),e.set("action","Save"),e.set("return_id",this.record),e.set("return_action","DetailView"),e.set("relate_to",this.module),e.set("relate_id",this.record),await this.$store.dispatch("ajaxPost",{data:e,sanitize:!0}),this.updateText="",this.internal=!1,this.getData()},showFullForm(){this.fullForm=!0},setEventListener(){"Cases"===this.module&&document.addEventListener("click",this.hideForm)},removeListener(){document.removeEventListener("click",this.hideForm)},hideForm(e){!this.$refs.case_updates.contains(e.target)&&0===this.updateText.length&&this.fullForm&&(this.fullForm=!1)}},watch:{caseTimelineValue(e){!1===e&&(this.timelineType="update_list")}}},N=s(40089);const F=(0,N.Z)(B,[["render",z],["__scopeId","data-v-669f7b5d"]]);var V=F},96385:function(e,t,s){s.r(t),s.d(t,{default:function(){return m}});var a=s(73396),i=s(87139);const l=e=>((0,a.dD)("data-v-4bd0c545"),e=e(),(0,a.Cn)(),e),n=l((()=>(0,a._)("i",{class:"fas fa-3x fa-sync-alt fa-spin"},null,-1))),o=[n];function r(e,t,s,l,n,r){return s.isShow?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"tab-preloader flex-column justify-content-center align-items-center",style:(0,i.j5)(n.styleObj)},o,4)):(0,a.kq)("",!0)}var d={name:"TabPreloader2",props:{isShow:{type:Boolean}},data(){return{styleObj:{height:"10px",width:"10px",opacity:0}}},updated(){this.updateStyle()},mounted(){this.updateStyle()},methods:{updateStyle(){let e=this.$el.parentElement,t=window.getComputedStyle(e).backgroundColor,s=e.getBoundingClientRect();s.height<80&&(e.style.minHeight="80px"),this.styleObj.backgroundColor=t,this.styleObj.height=s.height-2+"px",this.styleObj.width=s.width-2+"px",this.isShow?this.styleObj.opacity=1:this.styleObj.opacity=0}}},u=s(40089);const c=(0,u.Z)(d,[["render",r],["__scopeId","data-v-4bd0c545"]]);var m=c}}]);