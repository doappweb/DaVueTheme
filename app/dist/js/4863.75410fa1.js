"use strict";(self["webpackChunkdoapp_crmtheme"]=self["webpackChunkdoapp_crmtheme"]||[]).push([[4863],{64863:function(e,t,s){s.r(t),s.d(t,{default:function(){return T}});var r=s(73396),i=s(87139);const a={ref:"schedulerTable",class:"table table-bordered border-0 mt-5"},n={align:"right",style:{width:"100%"}},o={class:"text-sm time-label"},l=["id"],d={key:0,class:"text-sm time-label"},u={style:{width:"100%"}},c={class:"p-1 d-flex justify-content-start align-items-center"},p=["id"],h={class:"mt-1"},m=["onClick"];function _(e,t,s,_,f,v){const D=(0,r.up)("cellPopover");return(0,r.wg)(),(0,r.iD)("table",a,[(0,r._)("thead",n,[(0,r._)("tr",null,[(0,r._)("th",null,[(0,r._)("span",o,(0,i.zw)(v.getTimeLabel(v.zeroDTStamp)),1)]),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(v.colsAmount,(e=>((0,r.wg)(),(0,r.iD)("th",{class:(0,i.C_)(["border-right-0",{"border-left-0":e%4!==0}]),id:e,key:e},[v.headerShow(e)?((0,r.wg)(),(0,r.iD)("span",d,(0,i.zw)(v.getTimeLabel(v.zeroDTStamp+v.timeGap*e)),1)):(0,r.kq)("",!0)],10,l)))),128))])]),(0,r._)("tbody",u,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(s.persons,((e,s)=>((0,r.wg)(),(0,r.iD)("tr",{key:s},[(0,r._)("td",{class:"border-left-0",style:{position:"relative"},onMouseenter:t[0]||(t[0]=(...e)=>v.showPopover&&v.showPopover(...e)),onMouseleave:t[1]||(t[1]=(...e)=>v.hidePopover&&v.hidePopover(...e))},[(0,r._)("div",c,[(0,r._)("span",{class:(0,i.C_)(v.iconClass(e))},null,2),(0,r._)("div",{class:(0,i.C_)(["text-nowrap",{"text-underline-accept":"accept"===v.personInvitationStatus(e.fields.id),"text-underline-decline":"decline"===v.personInvitationStatus(e.fields.id)}])},(0,i.zw)(e.fields.name),3)]),(0,r.Wm)(D,{header:v.popoverHeader(e),body:v.popoverBody(e)},null,8,["header","body"])],32),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(v.colsAmount,(a=>((0,r.wg)(),(0,r.iD)("td",{key:a,id:s+"_"+(v.zeroDTStamp+v.timeGap*(a-1)),style:(0,i.j5)("width:"+v.colWidth),onMouseenter:t[2]||(t[2]=(...e)=>v.statusTitle&&v.statusTitle(...e)),class:(0,i.C_)(v.getBusyCellColor(a,s,e))},null,46,p)))),128)),(0,r._)("div",h,[(0,r._)("i",{role:"button",class:"bi bi-x-circle-fill text-danger ml-1",onClick:e=>v.deleteScheduledPerson(s)},null,8,m)])])))),128))])],512)}var f=s(6387),v={name:"CustomSchedulerTable",components:{CellPopover:f["default"]},props:{persons:{type:Array,required:!0},windowSize:{type:Object,required:!0}},data(){return{mergeId:999,recordId:this.$store.state.focus.get.record,date_start_unix:0,date_end_unix:0,recordInvitationStatuses:this.$store.state.focus.data.pageData.statusesAcceptingCurrentInvitation}},mounted(){this.setThemeStyle(),this.date_start_unix=this.recordStartDTStamp,this.date_end_unix=this.recordEndDTStamp},watch:{darkMode(){this.setThemeStyle()}},methods:{setThemeStyle(){this.$refs.schedulerTable&&this.darkMode?this.$refs.schedulerTable.classList.add("daDark"):this.$refs.schedulerTable&&this.$refs.schedulerTable.classList.remove("daDark")},iconClass(e){let t="mr-1 mt-1 suitepicon suitepicon-module-",s="";return e.module&&(s=e.module+"s"),e.moduleName&&(s=e.moduleName),t+=s.toLowerCase(),t},popoverHeader(e){return[e.fields.full_name]},popoverBody(e){let t=this.$store.state.app.list_strings.dom_meeting_accept_status[this.personInvitationStatus(e.fields.id)];return[{title:this.DOAPP.utils.translate("LBL_EMPLOYEE_STATUS","Users"),value:e.module},{title:this.DOAPP.utils.translate("LBL_TITLE","Users"),value:e.fields.title},{title:this.DOAPP.utils.translate("LBL_ACCEPT_STATUS","Calls"),value:t},{title:this.DOAPP.utils.translate("LBL_EMAIL","Calls"),value:e.fields.email}]},getTimeLabel(e){let t="",s=new Date(e).getHours(),r=new Date(e).getMinutes();return s>23&&(s-=24),0===r&&(r="00"),t=s+":"+r,t},getDTStamp(e,t){if(!e||!t){let e=Date.now();return e-6e4*new Date(e).getMinutes()}return Date.parse(e+" "+t)},deleteScheduledPerson(e){this.$store.commit("focus/updateReminderInvite",this.persons.filter(((t,s)=>s!==e)))},personInvitationStatus(e){let t="",s=this.recordInvitationStatuses.find((t=>t.inviteeId===e));return t=void 0!==s?s.acceptStatus:"none",t},statusTitle(e){let t="",s=this.$store.state.app.list_strings,r=["none","tentative","accept","decline","busy","conflict"];for(let i of r)if(e.target.className.includes(i)){if(Object.hasOwn(s.dom_meeting_accept_status,i)){t=s.dom_meeting_accept_status[i];break}if("conflict"===i){t=this.DOAPP.utils.translate("LBL_CONFLICT","Calendar");break}if("busy"===i){t=this.DOAPP.utils.translate("LBL_BUSY","Calendar");break}}return e.target.title=t},showPopover(e){e.target.lastChild.style.display="block"},hidePopover(e){e.target.lastChild.style.display="none"},getBusyCellColor(e,t,s){let r,i,a,n=s.freebusy.activities,o=this.recordStartDTStamp,l=this.recordEndDTStamp,d=this.zeroDTStamp+this.timeGap*(e-1),u=!1,c=!1,p=d===o,h=d===l-9e5,m="",_=o<=d&&d<=l-9e5;if(this.recordId&&this.recordInvitationStatuses.forEach((e=>{s.fields.id===e.inviteeId&&(u=!0,a=e.acceptStatus)})),this.DOAPP.utils.isEmpty(n))c=!1;else for(let v in n)r=1e3*n[v].startDateTime+this.timezoneOffset,i=1e3*n[v].endDateTime+this.timezoneOffset,r<=d&&d<i&&(c=!0);_?(m="inside",p&&(m+=" inside-start"),h&&(m+=" inside-end"),u&&o===this.date_start_unix&&l===this.date_end_unix?"accept"===a?m+=" inside-accept":"decline"===a?m+=" inside-decline":"none"===a?m+=" inside-none":"tentative"===a&&(m+=" inside-tentative"):m+=c?" inside-conflict":" inside-none"):(m="outside",m+=c?" outside-busy":" outside-free");let f=this.resizeHandler;return m.includes("inside-start")||(2===f&&e%f===0||4===f&&(e-1)%f%4!==0)&&(m=m.replace("outside","merge-outside"),m=m.replace("inside","merge-inside")),m},headerShow(e){let t=!1,s=this.resizeHandler,r=(e-4)%(4*s)===0,i=(e-4)%(2*s)===0||(e-8)%(4*s)===0;return 0!==e&&e%4!==0||(t=!0),(2!==s||!r)&&((4!==s||!i)&&t)}},computed:{darkMode(){return this.$store.state.app.setting.theme.darkMode},resizeHandler(){let e=this.windowSize.width,t=999;return e<576?4:e>=576&&e<768||e>=768&&e<992?2:e>=992&&e<1200||e>=1200?this.colsAmount+1:t},timeGap(){return 9e5},zeroDTStamp(){return this.recordStartDTStamp-144e5},recordStartDTStamp(){let e=Date.now();return this.startDate&&this.startTime&&(e=this.getDTStamp(this.startDate,this.startTime)),e},recordEndDTStamp(){let e=1e3*this.durationHours*60*60,t=1e3*this.durationMinutes*60;return this.recordStartDTStamp+e+t},timezoneOffset(){return this.DOAPP.dateTime.getTimezoneOffset()},startDate(){return this.getStartDateTime.startDate},startTime(){return this.getStartDateTime.startTime},durationHours(){return Number(this.$store.state.focus.data.beanData.duration_hours.value)},durationMinutes(){return Number(this.$store.state.focus.data.beanData.duration_minutes.value)},getStartDateTime(){let e,t,s,r=this.$store.state.focus.data.beanData.date_start.value,i=this.$store.state.user.data.userDateFormat,a=this.$store.state.user.data.userTimeFormat;if(!r)return"";[".","/","-"].forEach((e=>{i.includes(e)&&(s=e)}));let n="Y"+s+"m"+s+"d",o=r.split(" ");e=o[0],t=a.split(" ").length>1?o[1]+" "+o[2]:"A"===a.slice(-1)||"a"===a.slice(-1)?o[1].replace(o[1].slice(-2)," "+o[1].slice(-2)):o[1],t=t.replace(".",":");let l=e.split(s);return i!==n&&(i[0]===n[0]?[l[1],l[2]]=[l[2],l[1]]:i.split("").reverse().toString()===n.split("").toString()?l=l.reverse():(l=l.reverse(),[l[1],l[2]]=[l[2],l[1]])),{startDate:l.join(s),startTime:t}},colsAmount(){return 32+4*this.durationHours+this.durationMinutes/15},colWidth(){return 80/this.colsAmount+"%"}}},D=s(40089);const g=(0,D.Z)(v,[["render",_],["__scopeId","data-v-565d76f4"]]);var T=g},6387:function(e,t,s){s.r(t),s.d(t,{default:function(){return m}});var r=s(73396),i=s(87139);const a={class:"user-popover"},n={class:"user-popover__header border-bottom"},o={class:"user-popover__body p-2"},l={class:"text-bold text-nowrap"},d={class:"text-truncate"};function u(e,t,s,u,c,p){return(0,r.wg)(),(0,r.iD)("div",a,[(0,r._)("div",n,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(s.header,((e,t)=>((0,r.wg)(),(0,r.iD)("h5",{key:t,class:"user-popover__header-full-name text-bold pt-1"},(0,i.zw)(e),1)))),128))]),(0,r._)("div",o,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(s.body,((e,t)=>((0,r.wg)(),(0,r.iD)("div",{key:t,class:"user-popover__body-elem"},[(0,r._)("span",l,(0,i.zw)(e.title+": "),1),(0,r._)("span",d,(0,i.zw)(e.value),1)])))),128))])])}var c={name:"cellPopover",props:{header:{type:Array,required:!0},body:{type:Array,required:!0}}},p=s(40089);const h=(0,p.Z)(c,[["render",u],["__scopeId","data-v-4d0e382e"]]);var m=h}}]);