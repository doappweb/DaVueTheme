"use strict";(self["webpackChunkdoapp_crmtheme"]=self["webpackChunkdoapp_crmtheme"]||[]).push([[8215,2394],{82394:function(t,e,a){a.r(e);a(82801),a(61295);const s={computed:{getPresets(){return this.getKanbanSettings?.presets??[]},getActivePreset(){return this.getPresets.find((t=>!0===t.isActive))},getDetailLink(){return"?module="+this.module+"&offset="+this.offset+"&stamp="+this.stamp+"&record="+this.recordId+"&return_module="+this.module+"&parentTab="+this.parentTab+"&return_action=ListView&return_subAction=Kanban&action=DetailView"},getEditLink(){return"?module="+this.module+"&offset="+this.offset+"&stamp="+this.stamp+"&record="+this.recordId+"&return_module="+this.module+"&parentTab="+this.parentTab+"&return_action=ListView&return_subAction=Kanban&action=EditView"},pageData(){return this.$store.state.focus.data.pageData?this.$store.state.focus.data.pageData:{}},stamp(){return this.pageData.stamp?this.pageData.stamp:"0"},offset(){return this.pageData.offset?this.pageData.offset:"1"},parentTab(){return this.pageData.parentTab?this.pageData.parentTab:this.DOAPP.utils.translate("LBL_LINK_ALL")},module(){return this.$route.query.module},getKanbanSettings(){return this.$store.state.app.setting.kanban[this.module]},getSearchQuery(){return this.getKanbanSettings?this.getKanbanSettings.searchQuery:""}},methods:{async clearAll(t){await this.clearForm(),await this.applyForm(t),this.$store.commit("app/DEACTIVATE_KANBAN_PRESETS",this.module),window.$("#collapseKanbanSearchForm").collapse("hide"),window.$("#collapseKanbanPresetActions").collapse("hide")},clearForm(){this.$store.commit("focus/CLEAN_MODEL_PATH_VALUES",{path:"filters",row:"kanban",fields:this.$store.state.focus.data.filters.layout.advanced})},togglePresetActions(t){this.getSearchQuery||this.clearForm(t),window.$("#collapseKanbanSearchForm").collapse("hide"),window.$("#collapseKanbanPresetActions").collapse("toggle")},toggleFilter(){window.$("#collapseKanbanPresetActions").collapse("hide"),window.$("#collapseKanbanSearchForm").collapse("toggle")},async clearAndSearch(t){await this.clearForm(),await this.applyForm(t),this.$store.commit("app/DEACTIVATE_KANBAN_PRESETS",this.module)},async applyForm(t){let e=new FormData(t.target.form);await Object.keys(this.enumOptions).forEach((t=>{this.fetchKanbanColumnData(t,0,e)})),this.$store.dispatch("app/setKanbanFilterData"),this.$store.dispatch("app/setKanbanSearchQuery"),this.$store.dispatch("app/setSettings")},fetchKanbanColumnData(t,e="0",a=null){let s={module_name:this.$route.query.module,order:this.orderFieldName,offset:e,sortDirection:this.getKanbanSettings.sortDirection??"",status_field_name:this.fieldToEnum,status_field_value:t};this.$store.dispatch("focus/setKanbanData",{params:s,formData:a})},getSearchFormData(){let t=new FormData;if(t.append("searchFormTab","advanced_search"),this.getKanbanSettings){for(let e in this.getKanbanSettings.filters)this.getKanbanSettings.filters[e]&&t.append(e,this.getKanbanSettings.filters[e]);return t}return null},async openCreatePopup(t,e,a){let s=await this.getQuickCreateView(a),r=this.setQuickCreateParams(s,this.quickCreateParams),i={type:"quickCreate",header:{data:{title:"LBL_EMAIL_QUICK_CREATE",module:a},show:!0},body:{data:r,show:!0},footer:{data:{},show:!0}};i.body.data.module=a,i.body.data.record="",this.$store.dispatch("popup/setSize","xl"),this.$store.dispatch("popup/fill",i),this.$store.dispatch("popup/show")},async getQuickCreateView(t){let e={get:{module:"Home",VueAjax:1,method:"quickCreateView",arg:{targetModule:t}}},a=await this.$store.dispatch("ajaxGet",e);return a.data},setQuickCreateParams(t,e){let a=structuredClone(t);return e.forEach((t=>{a.beanData[t.name].value=t.value})),a},async chooseKanbanPreset(t){let e={id:t.target.id,module:this.module};await this.$store.dispatch("app/chooseKanbanPreset",e),await this.$store.dispatch("focus/setKanbanPresetValues",e),await this.applyForm(t),this.$store.commit("app/SET_ACTIVE_KANBAN_PRESET",e)}}};e["default"]=s},28215:function(t,e,a){a.r(e),a.d(e,{default:function(){return A}});var s=a(73396),r=a(87139);const i=["data-dr-item"],o={class:"card card-info card-outline"},n={"data-dr-handle":"",class:"card-header"},l={"data-dr-handle":"",class:"card-title"},d={class:"card-body"},c={class:"footer-tools"},u={class:"item-left"},h={class:"item-right"},p=(0,s._)("i",{class:"bi bi-eye"},null,-1),m=(0,s._)("i",{class:"bi bi-pencil-square"},null,-1);function g(t,e,a,g,f,b){const w=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("div",{"data-dr-item":a.recordId},[(0,s._)("div",o,[(0,s._)("div",n,[(0,s._)("h5",l,(0,r.zw)(a.recordFields.name),1)]),(0,s._)("div",d,[(0,s._)("p",null,(0,r.zw)(a.recordFields.description),1),(0,s._)("div",c,[(0,s._)("div",u,[(0,s._)("span",null,(0,r.zw)("#"+a.index),1)]),(0,s._)("div",h,[a.recordAccess["detail"]?((0,s.wg)(),(0,s.j4)(w,{key:0,to:t.getDetailLink,role:"button",title:t.DOAPP.utils.translate("LBL_VIEW_BUTTON")},{default:(0,s.w5)((()=>[p])),_:1},8,["to","title"])):(0,s.kq)("",!0),a.recordAccess["edit"]?((0,s.wg)(),(0,s.j4)(w,{key:1,to:t.getEditLink,role:"button",title:t.DOAPP.utils.translate("LBL_EDIT_BUTTON")},{default:(0,s.w5)((()=>[m])),_:1},8,["to","title"])):(0,s.kq)("",!0)])])])])],8,i)}var f=a(82394),b={name:"daKanbanColumnItem",props:{recordAccess:{type:Object,required:!0},recordFields:{type:Object,required:!0},recordId:{type:String,required:!0},index:{type:[String,Number],required:!0}},mixins:[f["default"]]},w=a(40089);const _=(0,w.Z)(b,[["render",g]]);var A=_}}]);