"use strict";(self["webpackChunkdoapp_crmtheme"]=self["webpackChunkdoapp_crmtheme"]||[]).push([[824,7290,6385,7222],{60824:function(e,t,a){a.r(t),a.d(t,{default:function(){return V}});var s=a(73396),l=a(87139),i=a(49242);const n=e=>((0,s.dD)("data-v-06bd5e70"),e=e(),(0,s.Cn)(),e),o={class:"row justify-content-between border-bottom"},r=n((()=>(0,s._)("i",{class:"mr-1 suitepicon suitepicon-module-history text-sm"},null,-1))),d={class:"col-md-12 col-lg-6 p-0"},u=["disabled"],c={value:"update_list"},m={value:"update_summary"},p={key:0,id:"case_updates"},h=["placeholder"],_={key:0,class:"d-flex justify-content-between border-bottom pb-2"},w={class:"custom-control custom-switch"},y={for:"internal",class:"custom-control-label small"},b={class:"input-group-sm"},g={class:"input-group-append"},D={key:0,class:"timeline mb-0 py-2"},f={class:"timeline-item"},T={class:"d-flex justify-content-between flex-wrap py-1"},k={class:"timeline-header"},C={class:"time"},L=n((()=>(0,s._)("i",{class:"fas fa-clock"},null,-1))),A={key:0},v={key:1},O={key:2,class:"m-0"},x={class:"text-bold mt-1"},E={class:"timeline-footer d-flex justify-content-end"},P=["onClick"],S={key:1,class:"container"},U={class:"text-center py-4 text-muted"};function z(e,t,a,n,z,B){const j=(0,s.up)("TabPreloader"),N=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",o,[(0,s._)("h5",null,[r,(0,s.Uk)(" "+(0,l.zw)(e.DOAPP.utils.translate("LBL_ACCUMULATED_HISTORY_BUTTON_LABEL")),1)]),(0,s._)("div",d,["Cases"===this.module?(0,s.wy)(((0,s.wg)(),(0,s.iD)("select",{key:0,class:"custom-select py-0",id:"select",name:"select","onUpdate:modelValue":t[0]||(t[0]=e=>z.timelineType=e),disabled:B.selectDisabled},[(0,s._)("option",c,(0,l.zw)(e.DOAPP.utils.translate("LBL_MODULE_NAME","AOP_Case_Updates")),1),(0,s._)("option",m,(0,l.zw)(e.DOAPP.utils.translate("LBL_ACCUMULATED_HISTORY_BUTTON_LABEL")+"+"+e.DOAPP.utils.translate("LBL_MODULE_NAME","AOP_Case_Updates")),1)],8,u)),[[i.bM,z.timelineType]]):(0,s.kq)("",!0)])]),"Cases"===this.module?((0,s.wg)(),(0,s.iD)("form",p,[(0,s.wy)((0,s._)("textarea",{name:"update_text",id:"update_text",placeholder:e.DOAPP.utils.translate("LBL_UPDATE_TEXT",a.module),onClick:t[1]||(t[1]=(...e)=>B.showFullForm&&B.showFullForm(...e)),class:(0,l.C_)(["textarea-style form-control form-control-sm mt-2 mb-2",B.textareaClass]),"onUpdate:modelValue":t[2]||(t[2]=e=>z.updateText=e)},null,10,h),[[i.nr,z.updateText]]),z.fullForm?((0,s.wg)(),(0,s.iD)("div",_,[(0,s._)("div",w,[(0,s.wy)((0,s._)("input",{type:"checkbox",class:"custom-control-input",id:"internal",name:"internal","onUpdate:modelValue":t[3]||(t[3]=e=>z.internal=e)},null,512),[[i.e8,z.internal]]),(0,s._)("label",y,(0,l.zw)(e.DOAPP.utils.translate("LBL_INTERNAL",a.module)),1)]),(0,s._)("div",b,[(0,s._)("div",g,[(0,s._)("button",{class:"btn btn-flat btn-info",type:"button",onClick:t[4]||(t[4]=(...e)=>B.saveCaseUpdates&&B.saveCaseUpdates(...e))},(0,l.zw)(this.DOAPP.utils.translate("LBL_SAVE_BUTTON_LABEL",a.module)),1)])])])):(0,s.kq)("",!0)])):(0,s.kq)("",!0),(0,s._)("div",{class:"overflow-auto mb-3 border rounded timeline-wrapper thin-scroll",style:(0,l.j5)(B.timelineStyle)},[(0,s.Wm)(j,{isShow:z.preloaderShow},null,8,["isShow"]),B.emptyShow?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",D,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(B.summaryData,((t,i)=>((0,s.wg)(),(0,s.iD)("div",{key:i},[(0,s._)("i",{class:(0,l.C_)(["far suitepicon",B.iconClass(t.module)])},null,2),(0,s._)("div",f,[(0,s._)("div",T,[(0,s._)("h3",k,[(0,s.Uk)((0,l.zw)(t.direction)+" "+(0,l.zw)(t.type)+" ",1),(0,s._)("b",null,(0,l.zw)(t.contact_name),1),(0,s._)("b",null,(0,l.zw)(t.status),1)]),(0,s._)("span",C,[L,(0,s.Uk)(" "+(0,l.zw)(t.date_type)+" "+(0,l.zw)(t.date_modified),1)])]),(0,s._)("div",{class:(0,l.C_)(["timeline-body border-top",t.class])},[t.acl.detail?((0,s.wg)(),(0,s.iD)("h5",A,[(0,s.Wm)(N,{to:{query:{module:t.module,action:"DetailView",record:t.id}}},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(t.name)+" "+(0,l.zw)(t.attachment),1)])),_:2},1032,["to"])])):((0,s.wg)(),(0,s.iD)("h5",v,(0,l.zw)(t.name)+" "+(0,l.zw)(t.attachment),1)),t.acl.detail?((0,s.wg)(),(0,s.iD)("p",O,(0,l.zw)(t.description),1)):(0,s.kq)("",!0),Object.hasOwn(t,"attachments")&&!Array.isArray(t.attachments)?((0,s.wg)(),(0,s.iD)(s.HY,{key:3},[(0,s._)("span",x,(0,l.zw)(e.DOAPP.utils.translate("LBL_AOP_CASE_ATTACHMENTS",a.module)),1),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.attachments,((e,t)=>((0,s.wg)(),(0,s.j4)(N,{key:t,class:"pl-2",to:"?module=Notes&action=DetailView&record="+t},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e),1)])),_:2},1032,["to"])))),128))],64)):(0,s.kq)("",!0)],2),(0,s._)("div",E,[t.acl.edit?((0,s.wg)(),(0,s.j4)(N,{key:0,class:"btn btn-info btn-sm ml-1",to:{query:{module:t.module,action:"EditView",record:t.id,return_module:this.module,return_action:"DetailView",return_id:this.record}}},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.DOAPP.utils.translate("LBL_EDIT_BUTTON")),1)])),_:2},1032,["to"])):(0,s.kq)("",!0),t.acl.delete?((0,s.wg)(),(0,s.iD)("a",{key:1,class:"btn btn-danger btn-sm ml-1",onClick:e=>B.deleteRelationship(t)},(0,l.zw)(e.DOAPP.utils.translate("LBL_DELETE_BUTTON")),9,P)):(0,s.kq)("",!0)])])])))),128))])),B.emptyShow?((0,s.wg)(),(0,s.iD)("div",S,[(0,s._)("p",U,(0,l.zw)(e.DOAPP.utils.translate("MSG_LIST_VIEW_NO_RESULTS_BASIC")),1)])):(0,s.kq)("",!0)],4)],64)}var B=a(96385),j={name:"TimeLine",components:{TabPreloader:B["default"]},props:{sectorHeight:Number,module:String,record:String},data(){return{timelineData:!1,preloaderShow:!0,timelineType:"update_list",internal:!1,updateText:"",fullForm:!1}},mounted(){this.getData(),this.setEventListener()},computed:{timelineStyle(){return this.timelineData?{"max-height":this.sectorHeight+"px"}:{}},summaryData(){return"Cases"===this.module?this.timelineData[this.timelineType]:this.timelineData.summary_list},emptyShow(){return!(this.timelineData&&!this.DOAPP.utils.isEmpty(this.summaryData))},textareaClass(){return this.fullForm?"textarea-focus":"textarea-blur"},selectDisabled(){return"Cases"===this.module&&!1===this.caseTimelineValue},caseTimelineValue(){return this.$store.state.app.setting.theme?.Cases_timeLine}},methods:{async deleteRelationship(e){let t=new FormData;t.append("module",this.module),t.append("action","DeleteRelationship"),t.append("record",this.record),t.append("linked_field",e.module.toLowerCase()),t.append("linked_id",e.id),t.append("refresh_page",1),await this.$store.dispatch("ajaxPost",{data:t,sanitize:!1}),this.$store.commit("app/SET_CONTENT_READY",!1),this.$store.commit("app/SET_CONTENT_READY",!0)},async getData(){let e=await this.$store.dispatch("ajaxGet",{get:{VueAjax:1,method:"getTimeline",arg:{module_name:this.module,record:this.record}},sanitize:!1});this.timelineData=e.data,this.preloaderShow=!1,console.log(this.emptyShow),console.log(this.timelineData)},iconClass(e){let t,a="suitepicon-module-"+e.replaceAll("_","-").toLowerCase();return t="Emails"===e?"bg-blue":"Meetings"===e?"bg-yellow":"Calls"===e?"bg-green":"Tasks"===e?"bg-indigo":"Notes"===e?"bg-cyan":"Cases"===e?"bg-purple":"bg-gray",a+" "+t},async saveCaseUpdates(){let e=new FormData(event.target.form);e.set("record",this.record),e.set("module",this.module),e.set("action","Save"),e.set("return_id",this.record),e.set("return_action","DetailView"),e.set("relate_to",this.module),e.set("relate_id",this.record),await this.$store.dispatch("ajaxPost",{data:e,sanitize:!0}),this.updateText="",this.internal=!1,this.getData()},showFullForm(){this.fullForm=!0},setEventListener(){"Cases"===this.module&&document.addEventListener("click",(e=>{let t=document.getElementById("case_updates");!t.contains(e.target)&&0===this.updateText.length&&this.fullForm&&(this.fullForm=!1)}))}},watch:{caseTimelineValue(e){!1===e&&(this.timelineType="update_list")}}},N=a(40089);const F=(0,N.Z)(j,[["render",z],["__scopeId","data-v-06bd5e70"]]);var V=F},96385:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var s=a(73396),l=a(87139);const i=e=>((0,s.dD)("data-v-4bd0c545"),e=e(),(0,s.Cn)(),e),n=i((()=>(0,s._)("i",{class:"fas fa-3x fa-sync-alt fa-spin"},null,-1))),o=[n];function r(e,t,a,i,n,r){return a.isShow?((0,s.wg)(),(0,s.iD)("div",{key:0,class:"tab-preloader flex-column justify-content-center align-items-center",style:(0,l.j5)(n.styleObj)},o,4)):(0,s.kq)("",!0)}var d={name:"TabPreloader2",props:{isShow:{type:Boolean}},data(){return{styleObj:{height:"10px",width:"10px",opacity:0}}},updated(){this.updateStyle()},mounted(){this.updateStyle()},methods:{updateStyle(){let e=this.$el.parentElement,t=window.getComputedStyle(e).backgroundColor,a=e.getBoundingClientRect();a.height<80&&(e.style.minHeight="80px"),this.styleObj.backgroundColor=t,this.styleObj.height=a.height-2+"px",this.styleObj.width=a.width-2+"px",this.isShow?this.styleObj.opacity=1:this.styleObj.opacity=0}}},u=a(40089);const c=(0,u.Z)(d,[["render",r],["__scopeId","data-v-4bd0c545"]]);var m=c}}]);