"use strict";(self["webpackChunkdoapp_crmtheme"]=self["webpackChunkdoapp_crmtheme"]||[]).push([[1262,2394],{82394:function(t,e,a){a.r(e);a(82801),a(61295);const s={computed:{getPresets(){return this.getKanbanSettings?.presets??[]},getActivePreset(){return this.getPresets.find((t=>!0===t.isActive))},getDetailLink(){return"?module="+this.module+"&offset="+this.offset+"&stamp="+this.stamp+"&record="+this.recordId+"&return_module="+this.module+"&parentTab="+this.parentTab+"&return_action=ListView&return_subAction=Kanban&action=DetailView"},getEditLink(){return"?module="+this.module+"&offset="+this.offset+"&stamp="+this.stamp+"&record="+this.recordId+"&return_module="+this.module+"&parentTab="+this.parentTab+"&return_action=ListView&return_subAction=Kanban&action=EditView"},pageData(){return this.$store.state.focus.data.pageData?this.$store.state.focus.data.pageData:{}},stamp(){return this.pageData.stamp?this.pageData.stamp:"0"},offset(){return this.pageData.offset?this.pageData.offset:"1"},parentTab(){return this.pageData.parentTab?this.pageData.parentTab:this.DOAPP.utils.translate("LBL_LINK_ALL")},module(){return this.$route.query.module},getKanbanSettings(){return this.$store.state.app.setting.kanban[this.module]},getSearchQuery(){return this.getKanbanSettings?this.getKanbanSettings.searchQuery:""}},methods:{async clearAll(t){await this.clearForm(),await this.applyForm(t),this.$store.commit("app/DEACTIVATE_KANBAN_PRESETS",this.module),window.$("#collapseKanbanSearchForm").collapse("hide"),window.$("#collapseKanbanPresetActions").collapse("hide")},clearForm(){this.$store.commit("focus/CLEAN_MODEL_PATH_VALUES",{path:"filters",row:"kanban",fields:this.$store.state.focus.data.filters.layout.advanced})},togglePresetActions(t){this.getSearchQuery||this.clearForm(t),window.$("#collapseKanbanSearchForm").collapse("hide"),window.$("#collapseKanbanPresetActions").collapse("toggle")},toggleFilter(){window.$("#collapseKanbanPresetActions").collapse("hide"),window.$("#collapseKanbanSearchForm").collapse("toggle")},async clearAndSearch(t){await this.clearForm(),await this.applyForm(t),this.$store.commit("app/DEACTIVATE_KANBAN_PRESETS",this.module)},async applyForm(t){let e=new FormData(t.target.form);await Object.keys(this.enumOptions).forEach((t=>{this.fetchKanbanColumnData(t,0,e)})),this.$store.dispatch("app/setKanbanFilterData"),this.$store.dispatch("app/setKanbanSearchQuery"),this.$store.dispatch("app/setSettings")},fetchKanbanColumnData(t,e="0",a=null){let s={module_name:this.$route.query.module,order:this.orderFieldName,offset:e,sortDirection:this.getKanbanSettings.sortDirection??"",status_field_name:this.fieldToEnum,status_field_value:t};this.$store.dispatch("focus/setKanbanData",{params:s,formData:a})},getSearchFormData(){let t=new FormData;if(t.append("searchFormTab","advanced_search"),this.getKanbanSettings){for(let e in this.getKanbanSettings.filters)this.getKanbanSettings.filters[e]&&t.append(e,this.getKanbanSettings.filters[e]);return t}return null},async openCreatePopup(t,e,a){let s=await this.getQuickCreateView(a),i=this.setQuickCreateParams(s,this.quickCreateParams),r={type:"quickCreate",header:{data:{title:"LBL_EMAIL_QUICK_CREATE",module:a},show:!0},body:{data:i,show:!0},footer:{data:{},show:!0}};r.body.data.module=a,r.body.data.record="",this.$store.dispatch("popup/setSize","xl"),this.$store.dispatch("popup/fill",r),this.$store.dispatch("popup/show")},async getQuickCreateView(t){let e={get:{module:"Home",VueAjax:1,method:"quickCreateView",arg:{targetModule:t}}},a=await this.$store.dispatch("ajaxGet",e);return a.data},setQuickCreateParams(t,e){let a=structuredClone(t);return e.forEach((t=>{a.beanData[t.name].value=t.value})),a},async chooseKanbanPreset(t){let e={id:t.target.id,module:this.module};await this.$store.dispatch("app/chooseKanbanPreset",e),await this.$store.dispatch("focus/setKanbanPresetValues",e),await this.applyForm(t),this.$store.commit("app/SET_ACTIVE_KANBAN_PRESET",e)}}};e["default"]=s}}]);