"use strict";(self["webpackChunkdoapp_crmtheme"]=self["webpackChunkdoapp_crmtheme"]||[]).push([[3254],{53254:function(t,e,a){a.r(e),a.d(e,{default:function(){return qt}});var s=a(73396),l=a(87139),i=a(49242);const r=t=>((0,s.dD)("data-v-611ef8ac"),t=t(),(0,s.Cn)(),t),o=["id"],n=["id"],d={"data-dr-handle":"",class:"card-title"},c=r((()=>(0,s._)("i",{class:"mr-1 suitepicon suitepicon-module-sugarfeed"},null,-1))),p={class:"card-tools"},u=["title","aria-label"],h=r((()=>(0,s._)("i",{class:"fas fa-cogs"},null,-1))),m=[h],g=["title","aria-label"],_=r((()=>(0,s._)("i",{class:"fas fa-sync-alt"},null,-1))),f=[_],D=["title","aria-label"],w=r((()=>(0,s._)("i",{class:"fas fa-times"},null,-1))),y=[w],k={class:"bd flex-grow-1"},v={class:"bd-center flex-column h-100"},L=["name","id"],P={class:"card-body"},b={href:"javascript:void(0)",class:"float-left mr-2 mt-1 text-muted a-btn"},x=["id"],B=r((()=>(0,s._)("i",{class:"fas fa-paperclip"},null,-1))),E=[B],F={class:"form-group row"},C={class:"input-group input-group-sm"},T={class:"input-group-append"},A=["id"],S={name:"link_type",class:"custom-select col-3"},H=["label","value"],O=["placeholder"],I={class:"direct-chat direct-chat-primary sugarFeedDashlet flex-grow-1"},M={class:"card-body p-0",id:"contentScroller"},U={key:0,class:"container"},z={class:"text-center py-3 text-muted"},N={id:"dashletPanel",class:"direct-chat-messages flex-column"},R=r((()=>(0,s._)("div",{class:"clearfix"},null,-1))),q={class:"direct-chat-infos clearfix"},$=["src"],j={class:"direct-chat-text"},K={key:0},V=["innerHTML"],Y={key:1},G={key:2,class:"embed-responsive embed-responsive-16by9"},W=["src"],X={key:3},Z=["src"],J={key:4},Q=["href"],tt={class:"sugarfeed-links"},et=["onClick"],at=r((()=>(0,s._)("i",{class:"far fa-trash-alt mr-1"},null,-1))),st={class:"float-right"},lt=["onClick"],it=r((()=>(0,s._)("i",{class:"far fa-comments mr-1"},null,-1))),rt=r((()=>(0,s._)("div",{class:"clear"},null,-1))),ot=["name","id"],nt=["value"],dt={class:"direct-chat-msg",style:{display:"block"}},ct={class:"direct-chat-infos clearfix"},pt={class:"direct-chat-name float-left"},ut={class:"input-group input-group-sm"},ht={class:"input-group-append"},mt=["form"],gt={key:0,class:"ml-5 text-sm"},_t={class:"direct-chat-infos clearfix"},ft=["src"],Dt={class:"direct-chat-text"},wt=["onClick"],yt=r((()=>(0,s._)("i",{class:"far fa-trash-alt mr-1"},null,-1))),kt={class:"card-footer"},vt={key:0,class:"pagination pagination-sm m-0 float-right"},Lt=["title"],Pt=r((()=>(0,s._)("a",{class:"page-link",href:"javascript:void(0)"},[(0,s._)("i",{class:"fas fa-angle-double-left"})],-1))),bt=[Pt],xt=["title"],Bt=r((()=>(0,s._)("a",{class:"page-link",href:"javascript:void(0)"},[(0,s._)("i",{class:"fas fa-angle-left"})],-1))),Et=[Bt],Ft={class:"page-item disabled"},Ct={class:"page-link",href:"javascript:void(0)"},Tt=["title"],At=r((()=>(0,s._)("a",{class:"page-link",href:"javascript:void(0)"},[(0,s._)("i",{class:"fas fa-angle-right"})],-1))),St=[At],Ht=["title"],Ot=r((()=>(0,s._)("a",{class:"page-link",href:"javascript:void(0)"},[(0,s._)("i",{class:"fas fa-angle-double-right"})],-1))),It=[Ot];function Mt(t,e,a,r,h,_){const w=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("div",{id:t.data.id,class:"card"},[(0,s._)("div",{"data-dr-handle":"",class:"card-header",id:"dashlet_header_"+t.data.id},[(0,s._)("h3",d,[c,(0,s.Uk)(" "+(0,l.zw)(t.DOAPP.utils.translate("LBL_HOMEPAGE_TITLE","SugarFeed")),1)]),(0,s._)("div",p,[t.lockHomepage?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("button",{key:0,type:"button",class:"btn btn-tool",title:t.DOAPP.utils.translate("LBL_DASHLET_EDIT","Home"),"aria-label":t.DOAPP.utils.translate("LBL_DASHLET_EDIT","Home"),onClick:e[0]||(e[0]=(...t)=>_.configDashlets&&_.configDashlets(...t))},m,8,u)),(0,s._)("button",{type:"button",class:"btn btn-tool",title:t.DOAPP.utils.translate("LBL_DASHLET_REFRESH","Home"),"aria-label":t.DOAPP.utils.translate("LBL_DASHLET_REFRESH","Home"),onClick:e[1]||(e[1]=(...e)=>t.retrieveDashlet&&t.retrieveDashlet(...e))},f,8,g),t.lockHomepage?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("button",{key:1,type:"button",class:"btn btn-tool",title:t.DOAPP.utils.translate("LBL_DASHLET_DELETE","Home"),"aria-label":t.DOAPP.utils.translate("LBL_DASHLET_DELETE","Home"),onClick:e[2]||(e[2]=(...e)=>t.deleteDashlet&&t.deleteDashlet(...e))},y,8,D))])],8,n),(0,s._)("div",k,[(0,s._)("div",v,[(0,s._)("form",{name:"form_"+t.data.id,id:"form_"+t.data.id},[(0,s._)("div",P,[(0,s._)("div",null,[(0,s._)("small",null,(0,l.zw)(t.DOAPP.utils.translate("LBL_POST_TITLE","SugarFeed"))+" "+(0,l.zw)(this.$store.state.user.data.username),1)]),(0,s._)("a",b,[(0,s._)("span",{id:"more_img_"+t.data.id,onClick:e[3]||(e[3]=(...t)=>_.toggleDisplayMore&&_.toggleDisplayMore(...t))},E,8,x)]),(0,s._)("div",F,[(0,s._)("div",C,[(0,s.wy)((0,s._)("input",{class:"form-control form-control-sm",id:"text",name:"text",type:"text","onUpdate:modelValue":e[4]||(e[4]=t=>h.text=t)},null,512),[[i.nr,h.text]]),(0,s._)("div",T,[(0,s._)("button",{class:"btn btn-flat btn-info",type:"button",onClick:e[5]||(e[5]=(...t)=>_.postMsg&&_.postMsg(...t))},(0,l.zw)(t.DOAPP.utils.translate("LBL_POST","SugarFeed")),1)])])]),(0,s.wy)((0,s._)("div",{id:"more_"+t.data.id,class:"input-group input-group-sm",style:{}},[(0,s._)("select",S,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.pageData.linkTypesOptions,((t,e)=>((0,s.wg)(),(0,s.iD)("option",{key:e,label:t,value:e},(0,l.zw)(t),9,H)))),128))]),(0,s.wy)((0,s._)("input",{type:"text",name:"link_url",class:"form-control",placeholder:t.DOAPP.utils.translate("LBL_URL_LINK_TITLE","SugarFeed"),"onUpdate:modelValue":e[6]||(e[6]=t=>h.link=t)},null,8,O),[[i.nr,h.link]])],8,A),[[i.F8,h.showMore]])])],8,L),(0,s._)("div",I,[(0,s._)("div",M,[_.dataIsEmpty?((0,s.wg)(),(0,s.iD)("div",U,[(0,s._)("p",z,(0,l.zw)(t.DOAPP.utils.translate("LBL_NO_DATA")),1)])):(0,s.kq)("",!0),(0,s._)("div",N,[R,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.data.viewData.data,((a,r)=>((0,s.wg)(),(0,s.iD)(s.HY,{key:r},[(0,s._)("div",{class:(0,l.C_)(["direct-chat-msg",_.isMsgFromCurUser(a.createdById)])},[(0,s._)("div",q,[(0,s._)("span",{class:(0,l.C_)(["direct-chat-name",_.getNameClass(a.createdById)])},(0,l.zw)(a.createdByName),3),(0,s._)("span",{class:(0,l.C_)(["direct-chat-timestamp",_.getDateClass(a.createdById)])},(0,l.zw)(a.dateEntered),3)]),(0,s._)("img",{class:"direct-chat-img",src:_.getPhotoPath(a),alt:"message user image"},null,8,$),(0,s._)("div",j,[a.isRelatedLink?((0,s.wg)(),(0,s.iD)("span",K,[(0,s.Uk)((0,l.zw)(a.createdByName)+" ",1),(0,s._)("span",{innerHTML:t.DOAPP.utils.translate(a.relatedLabel,"SugarFeed").replace("{0}"," ")},null,8,V),(0,s.Wm)(w,{to:"?module="+a.relatedModule+"&action=DetailView&record="+a.relatedId,class:"white"},{default:(0,s.w5)((()=>[(0,s._)("i",{class:(0,l.C_)("fas suitepicon suitepicon-module-"+a.relatedModule.toLowerCase())},null,2),(0,s.Uk)(" "+(0,l.zw)(a.relatedName),1)])),_:2},1032,["to"])])):((0,s.wg)(),(0,s.iD)("span",Y,(0,l.zw)(a.value),1)),"YouTube"===a.type?((0,s.wg)(),(0,s.iD)("div",G,[(0,s._)("iframe",{class:"embed-responsive-item",src:"https://www.youtube.com/embed/"+a.linkUrl,allowfullscreen:""},null,8,W)])):(0,s.kq)("",!0),"Image"===a.type?((0,s.wg)(),(0,s.iD)("div",X,[(0,s._)("img",{src:a.linkUrl.url,style:(0,l.j5)(_.getImageStyle(a.linkUrl))},null,12,Z)])):(0,s.kq)("",!0),"Link"===a.type?((0,s.wg)(),(0,s.iD)("div",J,[(0,s._)("a",{class:"white",href:a.linkUrl,target:"_blank"},(0,l.zw)(a.linkUrl),9,Q)])):(0,s.kq)("",!0)]),(0,s._)("p",tt,[_.isDeletable(a.createdById)?((0,s.wg)(),(0,s.iD)("a",{key:0,href:"javascript:void(0)",onClick:t=>_.deleteMsg(a.id),class:"link-black text-sm mr-2"},[at,(0,s.Uk)(" "+(0,l.zw)(t.DOAPP.utils.translate("LBL_DELETE_BUTTON_LABEL")),1)],8,et)):(0,s.kq)("",!0),(0,s._)("span",st,[(0,s._)("a",{href:"javascript:void(0)",onClick:t=>_.showReplyForm(a.id),class:"link-black text-sm mr-2"},[it,(0,s.Uk)(" "+(0,l.zw)(t.DOAPP.utils.translate("LBL_EMAIL_REPLY")),1)],8,lt)])]),(0,s.wy)((0,s._)("span",null,[rt,(0,s._)("blockquote",null,[(0,s._)("form",{name:"SugarFeedReplyForm_"+a.id,id:"SugarFeedReplyForm_"+a.id},[(0,s._)("input",{type:"hidden",name:"parentFeed",value:a.id},null,8,nt),(0,s._)("div",dt,[(0,s._)("div",ct,[(0,s._)("span",pt,(0,l.zw)(this.$store.state.user.data.username),1)]),(0,s._)("div",ut,[(0,s.wy)((0,s._)("input",{class:"form-control form-control-sm",id:"text",name:"text",type:"text","onUpdate:modelValue":e[7]||(e[7]=t=>h.reply=t)},null,512),[[i.nr,h.reply]]),(0,s._)("div",ht,[(0,s._)("button",{class:"btn btn-flat btn-info",type:"button",form:"SugarFeedReplyForm_"+a.id,onClick:e[8]||(e[8]=t=>_.replyToFeed())},(0,l.zw)(t.DOAPP.utils.translate("LBL_POST","SugarFeed")),9,mt)])])])],8,ot)])],512),[[i.F8,h.showReplayForm===a.id]])],2),a.replies.length?((0,s.wg)(),(0,s.iD)("div",gt,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.replies,((e,a)=>((0,s.wg)(),(0,s.iD)("div",{key:a,class:(0,l.C_)(["direct-chat-msg",_.isMsgFromCurUser(e.createdById)])},[(0,s._)("div",_t,[(0,s._)("span",{class:(0,l.C_)(["direct-chat-name text-xs",_.getNameClass(e.createdById)])},(0,l.zw)(e.createdByName),3),(0,s._)("span",{class:(0,l.C_)(["direct-chat-timestamp text-xs",_.getDateClass(e.createdById)])},(0,l.zw)(e.dateEntered),3)]),(0,s._)("img",{class:"direct-chat-img",src:_.getPhotoPath(e),alt:"message user image"},null,8,ft),(0,s._)("div",Dt,(0,l.zw)(e.value),1),_.isDeletable(e.createdById)?((0,s.wg)(),(0,s.iD)("a",{key:0,href:"javascript:void(0)",class:"link-black text-xs mr-2",onClick:t=>_.deleteMsg(e.id)},[yt,(0,s.Uk)((0,l.zw)(t.DOAPP.utils.translate("LBL_DELETE_BUTTON_LABEL")),1)],8,wt)):(0,s.kq)("",!0)],2)))),128))])):(0,s.kq)("",!0)],64)))),128))]),(0,s._)("div",kt,[t.dataNotEmpty()?((0,s.wg)(),(0,s.iD)("ul",vt,[t.paginationBtn.start?((0,s.wg)(),(0,s.iD)("li",{key:0,class:"page-item",name:"listViewStartButton",title:t.DOAPP.utils.translate("LNK_LIST_START"),onClick:e[9]||(e[9]=e=>_.paginationHandler(t.paginationBtn.start))},bt,8,Lt)):(0,s.kq)("",!0),t.paginationBtn.previous?((0,s.wg)(),(0,s.iD)("li",{key:1,class:"page-item",id:"sugarFeedPrevButton_top",name:"sugarFeedPrevButton",title:t.DOAPP.utils.translate("LNK_LIST_PREVIOUS"),onClick:e[10]||(e[10]=e=>_.paginationHandler(t.paginationBtn.previous))},Et,8,xt)):(0,s.kq)("",!0),(0,s._)("li",Ft,[(0,s._)("a",Ct,(0,l.zw)(t.paginationInfo()),1)]),t.paginationBtn.next?((0,s.wg)(),(0,s.iD)("li",{key:2,class:"page-item",id:"sugarFeedNextButton_top",name:"sugarFeedNextButton",title:t.DOAPP.utils.translate("LNK_LIST_NEXT"),onClick:e[11]||(e[11]=e=>_.paginationHandler(t.paginationBtn.next))},St,8,Tt)):(0,s.kq)("",!0),t.paginationBtn.end?((0,s.wg)(),(0,s.iD)("li",{key:3,class:"page-item",id:"sugarFeedEndButton_top",name:"sugarFeedEndButton",title:t.DOAPP.utils.translate("LNK_LIST_END"),onClick:e[12]||(e[12]=e=>_.paginationHandler(t.paginationBtn.end))},It,8,Ht)):(0,s.kq)("",!0)])):(0,s.kq)("",!0)])])])])])],8,o)}var Ut=a(72318),zt={name:"SugarFeedDashlet",extends:Ut["default"],data(){return{showMore:!1,showReplayForm:"",reply:"",text:"",link:""}},computed:{dataIsEmpty(){return!!this.DOAPP.utils.isEmpty(this.data.viewData.data)}},methods:{toggleDisplayMore(){this.showMore?(this.showMore=!1,this.link=""):this.showMore=!0},isMsgFromCurUser(t){let e="";return t===this.$store.state.user.data.id&&(e="right"),e},isDeletable(t){let e=!1;return(this.$store.state.user.data.is_admin||t===this.$store.state.user.data.id)&&(e="true"),e},async deleteMsg(t){let e=new FormData;e.set("to_pdf",1),e.set("module","Home"),e.set("action","CallMethodDashlet"),e.set("method","deleteUserFeed"),e.set("id",this.data.id),e.set("record",t),await this.$store.dispatch("ajaxPost",{data:e}),this.retrieveDashlet()},async postMsg(t){let e=new FormData(t.target.form);e.set("to_pdf",1),e.set("module","Home"),e.set("action","CallMethodDashlet"),e.set("method","pushUserFeed"),e.set("id",this.data.id),await this.$store.dispatch("ajaxPost",{data:e}),this.text="",this.retrieveDashlet(),this.showMore=!1,this.link=""},showReplyForm(t){this.reply="",this.showReplayForm=t},async replyToFeed(){let t=new FormData(event.target.form);t.set("to_pdf",1),t.set("module","Home"),t.set("action","CallMethodDashlet"),t.set("method","pushUserFeedReply"),t.set("id",this.data.id),await this.$store.dispatch("ajaxPost",{data:t}),this.showReplayForm="",this.retrieveDashlet()},async configDashlets(){let{title:t,data:e}=await this.$store.dispatch("focus/retrieveDashlet",this.data.id);this.open_popup(t,e,"SugarFeedDashletConfig",this.saveDashletConfigHandler)},open_popup(t,e,a="",s){this.$store.dispatch("popup/setSize","lg"),this.$store.dispatch("popup/fill",{type:a,header:{show:!0,data:{title:t}},body:{show:!0,data:{data:e,module:"SugarFeed",record:this.data.id}},footer:{show:!0,data:{onConfirm:s}}}),this.$store.dispatch("popup/show")},getPhotoPath(t){let e="assets/vendor/img/user_default.png";return t.photo&&(e="../index.php?"+t.photo),e},async paginationHandler(t){let e=decodeURI(t.substring(t.indexOf("?")+1)),a={get:{},id:this.data.id},s=["module","action","DynamicAction","lvso"];e.split("&").forEach((t=>{let[e,l]=t.split("=");s.includes(e)||(a.get[e]=l)})),this.$store.dispatch("focus/retrieveFeedDashPage",a)},getImageStyle(t){let e="width: 'auto'; max-width: 425px;";return 0!==t.width&&(e="width: "+t.width+"px; height: "+t.height+"px; border: 0px;"),e},getNameClass(t){let e="float-left";return t===this.$store.state.user.data.id&&(e="float-right"),e},getDateClass(t){let e="float-right";return t===this.$store.state.user.data.id&&(e="float-left"),e}}},Nt=a(40089);const Rt=(0,Nt.Z)(zt,[["render",Mt],["__scopeId","data-v-611ef8ac"]]);var qt=Rt}}]);