"use strict";(self["webpackChunkdoapp_crmtheme"]=self["webpackChunkdoapp_crmtheme"]||[]).push([[5060,5840,7106],{95840:function(t,e,n){n.r(e);const r={data(){return{config:{primeContainer:{selector:"data-dr-prime-container",current:""},container:{selector:"data-dr-container",current:""},item:{selector:"data-dr-item",current:""},handle:{selector:"data-dr-handle",current:""},active:{selector:"data-dr-item-active",current:""},target:{selector:"",current:""},back:{selector:"data-dr-back",current:""},isInsertBefore:!1},needToInsert:!0}},mounted(){this.initDragAndDrop()},updated(){this.initDragAndDrop()},methods:{initDragAndDrop(){const t=document.querySelectorAll("["+this.config.container.selector+"]");t.forEach((t=>{t.addEventListener("dragenter",this.onContainerDragEnter),t.querySelectorAll("["+this.config.item.selector+"]").forEach((t=>{t.hasAttribute(this.config.item.selector)&&(t.addEventListener("mousedown",this.setDraggable),t.addEventListener("dragstart",this.onDragStart),t.addEventListener("dragend",this.onDragEnd),t.addEventListener("dragleave",this.onDragLeave),t.addEventListener("dragover",this.onDragOver),this.addBackElement(t))}))}))},addBackElement(t){if(t.querySelector("["+this.config.back.selector+"]"))return;t.style.position="relative";let e=document.createElement("div");e.style.height="100%",e.style.width="100%",e.style.top=0,e.style.left=0,e.style.position="absolute",e.style.zIndex=-1,e.setAttribute(this.config.back.selector,""),t.appendChild(e)},onContainerDragEnter(t){if(t.stopPropagation(),!this.config.active.current)return;let e=this.config.container;if(e.current!==t.currentTarget&&e.current.getAttribute(e.selector)===t.currentTarget.getAttribute(e.selector))try{this.config.container.current=t.currentTarget}catch(n){return n}},onDragLeave(t){const e=document.elementsFromPoint(t.clientX,t.clientY);if(-1===e.findIndex((t=>this.config.target.current===t)))try{this.config.target.current.firstElementChild.style.boxShadow="",this.config.target.current.firstElementChild.style.marginBottom="1rem",this.config.target.current.firstElementChild.style.top=0}catch{return 0}},setDraggable(t){t.stopPropagation(),t.target.hasAttribute(this.config.handle.selector)&&(this.addBackElement(t.currentTarget),this.config.handle.current=t.target,this.config.active.current=t.currentTarget,this.config.container.current=this.config.active.current.parentNode,this.config.active.current.setAttribute("draggable",!0))},onDragStart(t){t.stopPropagation();try{this.config.active.current.setAttribute(this.config.active.selector,!0),this.config.active.current.classList.remove("wink"),this.config.primeContainer.current=this.config.active.current.parentNode}catch(e){return e}},onDragEnd(t){if(t.stopPropagation(),!this.config.active.current)return;const e=document.elementFromPoint(t.clientX,t.clientY),n=e.hasAttribute("data-dr-container"),r=e.getAttribute("data-dr-container"),a=this.config.active.current.parentNode,i=a.getAttribute("data-dr-container");let c;this.needToInsert&&(n&&r===i?(c=e.lastChild,e.appendChild(this.config.active.current)):this.config.container.current&&this.config.target.current&&(c=this.config.isInsertBefore?this.config.target.current:this.config.target.current.nextElementSibling,this.config.container.current.insertBefore(this.config.active.current,c))),this.customEndHandler(),this.config.target.current&&(this.config.target.current.firstElementChild.style.boxShadow="",this.config.target.current.firstElementChild.style.marginBottom="1rem",this.config.target.current.firstElementChild.style.top=0),this.config.active.current&&(this.config.active.current.removeAttribute(this.config.active.selector),this.config.active.current.classList.add("wink"),this.config.active.current.setAttribute("draggable",!1),this.config.active.current="")},onDragOver(t){t.stopPropagation(),t.preventDefault();const e=t.currentTarget;let n=e.parentNode,r=this.config.container.current;const a=n.getAttribute("data-dr-container"),i=this.config.container.current?this.config.container.current.getAttribute("data-dr-container"):"";if(a&&i){if(a!==i)return;this.config.container.current=n}else if(n!==r)return;const c=this.config.active.element!==e&&e.hasAttribute(this.config.item.selector);c&&(this.getInsertBefore(t),this.config.target.current=e,this.config.isInsertBefore&&this.config.target.current?(this.config.target.current.firstElementChild.style.boxShadow=" 0 -10px 5px rgba(0, 0, 0, 0.25)",this.config.target.current.firstElementChild.style.top="34px",this.config.target.current.firstElementChild.style.marginBottom="1rem",this.config.target.current.firstElementChild.style.transition="all 0.15s ease-in-out"):this.config.target.current&&(this.config.target.current.firstElementChild.style.boxShadow=" 0 10px 5px rgba(0, 0, 0, 0.25)",this.config.target.current.firstElementChild.style.top="0",this.config.target.current.firstElementChild.style.marginBottom="50px",this.config.target.current.firstElementChild.style.transition="all 0.15s ease-in-out"))},getInsertBefore(t){const e=t.currentTarget.querySelector("["+this.config.back.selector+"]");let n;e&&(n=e.getBoundingClientRect(),t.clientX>=n.x&&t.clientX<=n.right&&t.clientY>n.y&&t.clientY<=n.bottom&&(this.config.isInsertBefore=t.clientY-n.y<n.height/2))},customEndHandler(){console.log("Drag&Drop done - custom logic")}},beforeUnmount(){document.removeEventListener("mousedown",this.setDraggable),document.removeEventListener("dragstart",this.onDragStart),document.removeEventListener("dragend",this.onDragEnd),document.removeEventListener("dragover",this.onDragOver)}};e["default"]=r},27106:function(t,e,n){n.r(e),e["default"]={0:"#f8f9fa",1:"#bbecf1",2:"#98e1dc",3:"#e3f299",4:"#ffee95",5:"#ffdd93",6:"#dfd3b6",7:"#e3c6bb",8:"#ffad97",9:"#ffbdbb",10:"#ffcbd8",11:"#ffc4e4",12:"#c4baed",13:"#dbdde0",14:"#bfc5cd",15:"#ffffff",16:"#2eceff",17:"#10e5fc",18:"#a5de00",19:"#eec200",20:"#ffa801",21:"#ad8f47",22:"#b57051",23:"#ff5b55",24:"#ef3000",25:"#f968b6",26:"#6b52cc",27:"#06bab1",28:"#5cd1df",29:"#a1a6ac",30:"#949da9",31:"#ffb79f",32:"#ffbf99",33:"#f3e27c",34:"#e7d35d",35:"#53e553",36:"#00a64c",37:"#48dfdf",38:"#de62de",39:"#ef008b",40:"#0000ff",41:"#ebebeb",42:"#acacac",43:"#898989",44:"#f89675",45:"#fdad7e",46:"#fec788",47:"#fff893",48:"#c5e099",49:"#a3d49b",50:"#8ed1a8",51:"#7ecb9c",52:"#78cdca",53:"#67cef9",54:"#7aa5da",55:"#887fc0",56:"#a284bf",57:"#bd8bc0",58:"#f69ac1",59:"#f6989c",60:"#f26b47",61:"#f78d4d",62:"#fdb051",63:"#fff55a",64:"#abd46c",65:"#7bc56f",66:"#00bbb4",67:"#00bef6",68:"#00bdb5",69:"#3fb2cd",70:"#3f8bcd",71:"#5471b9",72:"#865daa",73:"#a861ab",74:"#f16ca8",75:"#f26b7b",76:"#f11716",77:"#f36509",78:"#f99500",79:"#fff300",80:"#8ec82f",81:"#2fb644",82:"#00a74c",83:"#00a99d",84:"#00adf2",85:"#0070bf",86:"#0052a7",87:"#662793",88:"#922091",89:"#f0008c",90:"#f10057",91:"#9e0502",92:"#a34100",93:"#a46200",94:"#aba100",95:"#578520",96:"#107c2c",97:"#007333",98:"#00736a",99:"#0075a6",100:"#004982",101:"#003172",102:"#1c0d64",103:"#460663",104:"#630060",105:"#a0005c",106:"#9f0037",107:"#2e2d93",108:"#555555",109:"#000000"}},75060:function(t,e,n){n.r(e),n.d(e,{default:function(){return h}});var r=n(73396),a=n(87139);const i={class:"kanban-content pb-3"},c={"data-dr-container":"kanban",class:"kanban-container h-100"};function s(t,e,n,s,o,d){const l=(0,r.up)("daKanbanColumn");return(0,r.wg)(),(0,r.iD)("div",{ref:"Kanban",class:"kanban-wrapper",style:(0,a.j5)(n.styleObj)},[(0,r._)("div",i,[(0,r._)("div",c,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(n.enumOptions,((a,i,c)=>((0,r.wg)(),(0,r.iD)("div",{"data-dr-item":"",key:i},[(0,r.Wm)(l,{statusTranslate:a,statusKey:i,index:c,fieldToEnum:n.fieldToEnum,getKanban:d.getKanban,onUpdatedRecords:e[0]||(e[0]=e=>t.initDragAndDrop())},null,8,["statusTranslate","statusKey","index","fieldToEnum","getKanban"])])))),128))])])],4)}n(82801),n(61295);var o=n(36761),d=n(82394),l=n(95840),u={name:"daKanbanBody",components:{daKanbanColumn:o["default"]},props:{styleObj:{type:Object},enumOptions:{type:Object,required:!0},orderFieldName:{type:String},fieldToEnum:{type:String}},emits:["updateStyleObject"],mixins:[d["default"],l["default"]],mounted(){this.calcHeight(),this.initKanban()},computed:{getKanban(){return this.$store.state.focus.data.viewData&&this.$store.state.focus.data.viewData.kanban?this.$store.state.focus.data.viewData.kanban:{}}},methods:{calcHeight(){let t=structuredClone(this.styleObj),e=this.$refs.Kanban.getBoundingClientRect(),n=window.document.querySelector(".main-footer").getBoundingClientRect();t.height=n.top-e.top-1+"px",this.$emit("updateStyleObject",t)},initKanban(){let t=this.getSearchFormData();Object.keys(this.enumOptions).forEach((e=>{this.fetchKanbanColumnData(e,0,t)}))},customEndHandler(){const t=this.config.active.current.getAttribute("data-dr-item"),e=this.config.primeContainer.current.id,n=this.config.active.current.parentNode.id;console.log(e,"+",n,"+",t),void 0!==n&&t&&this.saveRecord(e,n,t)},async saveRecord(t,e,n){let r=new FormData;r.append("module",this.module),r.append("record",n),r.append("field",this.fieldToEnum),r.append("value",e);let a=await this.$store.dispatch("ajaxPost",{get:{method:"saveKanban",VueAjax:!0},data:r});a.data&&[t,e].forEach((t=>{this.setRowsCount(t)}))},async setRowsCount(t){let e={module_name:this.module,status_field_name:this.fieldToEnum,status_field_value:t,get_row_count:!0},n=this.getSearchFormData();this.$store.dispatch("focus/setKanbanColumnRowCount",{params:e,formData:n})}}},f=n(40089);const g=(0,f.Z)(u,[["render",s],["__scopeId","data-v-19ba528c"]]);var h=g},36761:function(t,e,n){n.r(e),n.d(e,{default:function(){return y}});var r=n(73396),a=n(87139);const i={class:"item-left","data-dr-handle":""},c=["title"],s={"data-dr-handle":""},o={class:"item-right"},d={class:"badge bg-gray-light"},l=["title"],u=["id"];function f(t,e,n,f,g,h){const m=(0,r.up)("daKanbanColumnItem");return(0,r.wg)(),(0,r.iD)("div",{class:(0,a.C_)(["card",{"kanban-hide":g.hide,"kanban-col":!g.hide}])},[(0,r._)("div",{"data-dr-handle":"",class:"card-header column-header",style:(0,a.j5)({backgroundColor:h.getHexes[n.index]})},[(0,r._)("div",i,[(0,r._)("i",{class:(0,a.C_)(["bi",{"bi-chevron-right":!g.hide,"bi-chevron-down":g.hide}]),role:"button",title:t.DOAPP.utils.translate("LBL_HIDE"),onClick:e[0]||(e[0]=(...t)=>h.collapseHandler&&h.collapseHandler(...t))},null,10,c),(0,r._)("span",s,(0,a.zw)(n.statusKey?n.statusTranslate:"-----"),1)]),(0,r._)("div",o,[(0,r._)("span",d,(0,a.zw)(h.getColumnRecordListLength),1),(0,r._)("i",{class:"bi bi-plus-square",role:"button",title:t.DOAPP.utils.translate("LBL_ADD_BUTTON"),onClick:e[1]||(e[1]=(...t)=>h.plusHandler&&h.plusHandler(...t))},null,8,l)])],4),(0,r._)("div",{"data-dr-container":"column",id:n.statusKey,onScroll:e[2]||(e[2]=(...t)=>h.scrollHandler&&h.scrollHandler(...t)),class:"card-body scroll-padding"},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(h.getColumnRecordList,((e,n,a)=>((0,r.wg)(),(0,r.j4)(m,{key:n,recordAccess:h.getColumnRecordAccess[n],recordFields:e,recordId:n,module:t.module,offset:t.offset,index:a},null,8,["recordAccess","recordFields","recordId","module","offset","index"])))),128))],40,u)],2)}var g=n(28215),h=n(82394),m=n(27106),b={name:"daKanbanColumn",components:{daKanbanColumnItem:g["default"]},mixins:[h["default"]],emits:["updatedRecords"],props:{getKanban:{type:Object,required:!0},fieldToEnum:{type:String,required:!0},statusTranslate:{type:String,required:!0},statusKey:{type:String,required:!0},index:{type:Number,required:!0}},data(){return{hide:!1}},updated(){this.$emit("updatedRecords")},computed:{getHexes(){return m["default"]},columnData(){return this.getKanban?this.getKanban[this.statusKey]:{}},quickCreateParams:{get(){return[{name:this.fieldToEnum,value:this.statusKey}]},set(t){console.log(t)}},getColumnRecordList(){return this.columnData?this.columnData.recordList:{}},getColumnRecordListLength(){return this.columnData?this.columnData.rowCount:0},getColumnRecordAccess(){return this.columnData?this.columnData.recordAccess:0}},methods:{collapseHandler(){this.toggleColumn()},toggleColumn(){this.hide=!this.hide},plusHandler(){this.openCreatePopup(this.fieldToEnum,this.statusKey,this.module)},scrollHandler(t){this.endOfScrollHandler(t)},endOfScrollHandler(t){const e=t.target.scrollHeight,n=t.target.scrollTop,r=t.target.clientHeight;if(e===n+r){let t=this.getSearchFormData();this.fetchKanbanColumnData(this.statusKey,this.columnData.nextOffset,t)}}}},p=n(40089);const v=(0,p.Z)(b,[["render",f],["__scopeId","data-v-070e94f6"]]);var y=v},28215:function(t,e,n){n.r(e),n.d(e,{default:function(){return D}});var r=n(73396),a=n(87139);const i=["data-dr-item"],c={class:"card card-info card-outline"},s={"data-dr-handle":"",class:"card-header"},o={"data-dr-handle":"",class:"card-title"},d={class:"card-body"},l={class:"footer-tools"},u={class:"item-left"},f={class:"item-right"},g=(0,r._)("i",{class:"bi bi-eye"},null,-1),h=(0,r._)("i",{class:"bi bi-pencil-square"},null,-1);function m(t,e,n,m,b,p){const v=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("div",{"data-dr-item":n.recordId},[(0,r._)("div",c,[(0,r._)("div",s,[(0,r._)("h5",o,(0,a.zw)(n.recordFields.name),1)]),(0,r._)("div",d,[(0,r._)("p",null,(0,a.zw)(n.recordFields.description),1),(0,r._)("div",l,[(0,r._)("div",u,[(0,r._)("span",null,(0,a.zw)("#"+n.index),1)]),(0,r._)("div",f,[n.recordAccess["detail"]?((0,r.wg)(),(0,r.j4)(v,{key:0,to:t.getDetailLink,role:"button",title:t.DOAPP.utils.translate("LBL_VIEW_BUTTON")},{default:(0,r.w5)((()=>[g])),_:1},8,["to","title"])):(0,r.kq)("",!0),n.recordAccess["edit"]?((0,r.wg)(),(0,r.j4)(v,{key:1,to:t.getEditLink,role:"button",title:t.DOAPP.utils.translate("LBL_EDIT_BUTTON")},{default:(0,r.w5)((()=>[h])),_:1},8,["to","title"])):(0,r.kq)("",!0)])])])])],8,i)}var b=n(82394),p={name:"daKanbanColumnItem",props:{recordAccess:{type:Object,required:!0},recordFields:{type:Object,required:!0},recordId:{type:String,required:!0},index:{type:[String,Number],required:!0}},mixins:[b["default"]]},v=n(40089);const y=(0,v.Z)(p,[["render",m]]);var D=y}}]);