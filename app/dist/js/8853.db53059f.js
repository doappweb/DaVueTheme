"use strict";(self["webpackChunkdoapp_crmtheme"]=self["webpackChunkdoapp_crmtheme"]||[]).push([[8853,397,9112],{50397:function(e,t,s){s.r(t),t["default"]={"#007bff":"Primary","#6c757d":"Secondary","#17a2b8":"Info","#28a745":"Success","#ffc107":"Warning","#dc3545":"Danger","#6610f2":"Indigo","#3c8dbc":"Lightblue","#605ca8":"Purple","#e83e8c":"Pink","#f8f8f8":"Default"}},49112:function(e,t,s){s.r(t);s(82801),s(61295),s(57658);var a=s(50397),l=s(24239);const r={computed:{getColorScheme(){let e={};e=Object.assign({},this.calendarSettings.activityColors);for(let t in e)for(let s in e[t])"label"!==s&&(e[t][s]=this.getColorCodeToInput(e[t][s],t));return e},focusData(){return!0===this.isDashlet?this.$store.state.focus.data.viewData.panelsData[this.dashletId].viewData.data:this.$store.state.focus.data},isDashlet(){return this.$store.getters["app/getCalendarIsDashlet"]},dashletId(){return this.$store.getters["app/getCalendarDashletId"]},calendarSettings(){return this.DOAPP.utils.isEmpty(this.$store.state.app.setting.calendar.settings)&&this.$store.commit("app/SET_DEFAULT_SETTINGS",structuredClone(this.$store.getters["app/getDefaultCalendarSettings"])),this.$store.state.app.setting.calendar.settings},sharedUsers(){return this.$store.state.app.setting.calendar.sharedUsers},sharedUsersNames(){let e={};return this.sharedUsers.length&&this.availableSharedUsers&&this.sharedUsers.forEach((t=>{e[t]=this.availableSharedUsers[t]})),e},isEmptySharedUsers(){return!this.sharedUsers.length},availableSharedUsers(){let e={};return this.focusData&&this.focusData.availableSharedUsers&&(e=this.focusData.availableSharedUsers),e},isOnlyMineFlag(){return this.$store.state.app.setting.calendar.isOnlyMineFlag},savedCalendarPresets(){return this.$store.state.app.setting.saved_calendar_presets},hasSavedPresets(){return!!this.savedCalendarPresets.length},activePreset(){return this.savedCalendarPresets.find((e=>!0===e.isActive))},hasActivePreset(){return!!this.activePreset}},methods:{toggleFilter(){window.$("#collapseCalendarSettings").collapse("hide"),window.$("#collapsePresetActions").collapse("hide"),window.$("#collapseCalendarSelectUsers").collapse("toggle")},toggleSettings(){window.$("#collapseCalendarSelectUsers").collapse("hide"),window.$("#collapsePresetActions").collapse("hide"),window.$("#collapseCalendarSettings").collapse("toggle")},togglePresetActions(){window.$("#collapseCalendarSelectUsers").collapse("hide"),window.$("#collapseCalendarSettings").collapse("hide"),window.$("#collapsePresetActions").collapse("toggle")},async clearAll(e){window.$("#collapseCalendarSelectUsers").collapse("hide"),window.$("#collapsePresetActions").collapse("hide"),window.$("#collapseCalendarSettings").collapse("hide"),l["default"].commit("app/UPDATE_SHARED_USERS",[],{root:!0}),await this.setSharedUsers(),await this.cleanSettings(),await this.acceptSettings(e,!0)},toggleToDarkTheme(e){let t=[];t.push(document.querySelector(".dhx_cal_container")),t.push(document.querySelector(".dhx_cal_navline.dhx_cal_navline_flex")),t.push(document.querySelector(".dhx_cal_header")),t.push(document.querySelector(".dhx_cal_data")),t.push(document.querySelector(".dhx_scale_holder_now"));for(let s of t)s&&(e?s.classList.add("dark"):s.classList.remove("dark"))},async cleanSettings(){this.$store.commit("app/CLEAR_SETTINGS",structuredClone(this.$store.getters["app/getDefaultCalendarSettings"]))},async acceptSharedUsers(e,t){this.$store.commit("app/DEACTIVATE_CALENDAR_PRESETS"),await this.setSharedUsers(t),await this.setCalendarConfiguration(e)},async setCalendarConfiguration(e,t=!1){let s=new FormData(e.target.form),a=new FormData;if(t)a.append("day",l["default"].state.app.setting.calendar.settings.selectedDay),a.append("month",l["default"].state.app.setting.calendar.settings.selectedMonth),a.append("year",l["default"].state.app.setting.calendar.settings.selectedYear),a.append("view",l["default"].getters["app/getCalendarView"]());else for(let n of s.entries())n[1]=this.booleanTransform(n[1]),a.append(n[0],n[1]),"view"===n[0]&&(n[1]=l["default"].getters["app/getCalendarView"](),a.append(n[0],n[1]));let r={get:{module:"Calendar",action:"SaveSettings"},data:t?a:s};await this.$store.dispatch("focus/setCalendarSettings",r)},async acceptSettings(e,t=!1){this.$store.commit("app/DEACTIVATE_CALENDAR_PRESETS"),await this.setCalendarConfiguration(e,t)},setSharedUsers(e=[]){this.$store.dispatch("focus/setSharedUsers",e)},getColorCodeToInput(e,t){let s=e;return e.includes("#")||(s="#"+s),s=s.toLowerCase(),Object.hasOwn(a["default"],s)||(s=l["default"].getters["app/getDefaultCalendarSettings"].settings.activityColors[t].body),s},setColorScheme(e,t,s){let a=Object.assign({},this.getColorScheme);a[t][s]=e},setColors(){let e=this.calendarSettings.activityColors;for(let t in e){let s=".dhx_cal_event.event_"+t+" div, .dhx_cal_event_line.event_"+t,a=s+", .dhx_cal_event.dhx_cal_editor.event_"+t,l=".dhx_cal_event_clear.event_"+t,r=this.getSSClass(s.split(",")),n=this.getSSClass(a.split(",")),i=this.getSSClass(l.split(","));if(!(r&&n&&i))break;r.borderColor=e[t].border,n.backgroundColor=e[t].body,n.color=e[t].text,i.color=e[t].body}return!0},getSSClass(e){let t=!1;for(let s in document.styleSheets)for(let a in document.styleSheets[s].cssRules)if(document.styleSheets[s].cssRules[a].selectorText)for(let l of e){if(!document.styleSheets[s].cssRules[a].selectorText.includes(l))break;t=document.styleSheets[s].cssRules[a].style}return t},booleanTransform(e){return"on"===e||e}}};t["default"]=r}}]);